<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Language.Lambda.Typed</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier">Variable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier">Metavariable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#Expression"><span class="hs-identifier">Expression</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Var"><span class="hs-identifier">Var</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavar"><span class="hs-identifier">Metavar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#typeOf"><span class="hs-identifier">typeOf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier">Heading</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier">NormalTerm'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier">NormalTerm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#RigidTerm"><span class="hs-identifier">RigidTerm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#FlexibleTerm"><span class="hs-identifier">FlexibleTerm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#asNormalTerm"><span class="hs-identifier">asNormalTerm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier">DisagreementSet</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier">Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#someVariables"><span class="hs-identifier">someVariables</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#someMetavariables"><span class="hs-identifier">someMetavariables</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#solve"><span class="hs-identifier">solve</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bimap</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&amp;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">head</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">data</span><span> </span><span id="Type"><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-var">Type</span></a></span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Base"><span class="annot"><a href="Language.Lambda.Typed.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Function"><span class="annot"><a href="Language.Lambda.Typed.html#Function"><span class="hs-identifier hs-var">Function</span></a></span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679246927"><span id="local-6989586621679246934"><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
(Type -&gt; Type -&gt; Bool) -&gt; (Type -&gt; Type -&gt; Bool) -&gt; Eq Type
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Type -&gt; Type -&gt; Bool
== :: Type -&gt; Type -&gt; Bool
$c/= :: Type -&gt; Type -&gt; Bool
/= :: Type -&gt; Type -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679246939"><span id="local-6989586621679246944"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>  </span><span id="local-6989586621679246950"><span class="annot"><span class="annottext">show :: Type -&gt; String
</span><a href="#local-6989586621679246950"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span id="local-6989586621679246952"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679246952"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679246952"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span id="local-6989586621679246953"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246953"><span class="hs-identifier hs-var">parameter</span></a></span></span><span> </span><span id="local-6989586621679246954"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246954"><span class="hs-identifier hs-var">returnType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679246955"><span class="hs-identifier hs-var">parameter'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; -&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246954"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-42"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>    </span><span id="local-6989586621679246955"><span class="annot"><span class="annottext">parameter' :: String
</span><a href="#local-6989586621679246955"><span class="hs-identifier hs-var hs-var">parameter'</span></a></span></span><span>
</span><span id="line-44"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246953"><span class="hs-identifier hs-var">parameter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246953"><span class="hs-identifier hs-var">parameter</span></a></span><span>
</span><span id="line-45"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246953"><span class="hs-identifier hs-var">parameter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246953"><span class="hs-identifier hs-var">parameter</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="annot"><a href="Language.Lambda.Typed.html#dropParameters"><span class="hs-identifier hs-type">dropParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-48"></span><span id="dropParameters"><span class="annot"><span class="annottext">dropParameters :: Int -&gt; Type -&gt; Type
</span><a href="Language.Lambda.Typed.html#dropParameters"><span class="hs-identifier hs-var hs-var">dropParameters</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679246961"><span class="annot"><span class="annottext">typ :: Type
</span><a href="#local-6989586621679246961"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246961"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-49"></span><span class="annot"><a href="Language.Lambda.Typed.html#dropParameters"><span class="hs-identifier hs-var">dropParameters</span></a></span><span> </span><span id="local-6989586621679246962"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679246962"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679246963"><span class="annot"><span class="annottext">typ :: Type
</span><a href="#local-6989586621679246963"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679246964"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246964"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679246962"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246963"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; Type
</span><a href="Language.Lambda.Typed.html#dropParameters"><span class="hs-identifier hs-var">dropParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679246962"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246964"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="annot"><a href="Language.Lambda.Typed.html#takeParameters"><span class="hs-identifier hs-type">takeParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-54"></span><span id="takeParameters"><span class="annot"><span class="annottext">takeParameters :: Int -&gt; Type -&gt; [Type]
</span><a href="Language.Lambda.Typed.html#takeParameters"><span class="hs-identifier hs-var hs-var">takeParameters</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-55"></span><span class="annot"><a href="Language.Lambda.Typed.html#takeParameters"><span class="hs-identifier hs-var">takeParameters</span></a></span><span> </span><span id="local-6989586621679246967"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679246967"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span id="local-6989586621679246968"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246968"><span class="hs-identifier hs-var">parameter</span></a></span></span><span> </span><span id="local-6989586621679246969"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246969"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679246967"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246968"><span class="hs-identifier hs-var">parameter</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; [Type] -&gt; [Type]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; [Type]
</span><a href="Language.Lambda.Typed.html#takeParameters"><span class="hs-identifier hs-var">takeParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679246967"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246969"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><a href="Language.Lambda.Typed.html#countParameters"><span class="hs-identifier hs-type">countParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-60"></span><span id="countParameters"><span class="annot"><span class="annottext">countParameters :: Type -&gt; Int
</span><a href="Language.Lambda.Typed.html#countParameters"><span class="hs-identifier hs-var hs-var">countParameters</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-61"></span><span class="annot"><a href="Language.Lambda.Typed.html#countParameters"><span class="hs-identifier hs-var">countParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679246971"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246971"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int
</span><a href="Language.Lambda.Typed.html#countParameters"><span class="hs-identifier hs-var">countParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246971"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><a href="Language.Lambda.Typed.html#getExtraParameters"><span class="hs-identifier hs-type">getExtraParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-64"></span><span id="getExtraParameters"><span class="annot"><span class="annottext">getExtraParameters :: Type -&gt; Type -&gt; Maybe [Type]
</span><a href="Language.Lambda.Typed.html#getExtraParameters"><span class="hs-identifier hs-var hs-var">getExtraParameters</span></a></span></span><span> </span><span id="local-6989586621679246974"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246974"><span class="hs-identifier hs-var">returnType</span></a></span></span><span> </span><span id="local-6989586621679246975"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246975"><span class="hs-identifier hs-var">wholeType</span></a></span></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246976"><span class="hs-identifier hs-var">remainingType</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246974"><span class="hs-identifier hs-var">returnType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Maybe [Type]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679246977"><span class="hs-identifier hs-var">extraParameters</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [Type]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-67"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>  </span><span id="local-6989586621679246979"><span class="annot"><span class="annottext">extraParametersCount :: Int
</span><a href="#local-6989586621679246979"><span class="hs-identifier hs-var hs-var">extraParametersCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int
</span><a href="Language.Lambda.Typed.html#countParameters"><span class="hs-identifier hs-var">countParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246975"><span class="hs-identifier hs-var">wholeType</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Int
</span><a href="Language.Lambda.Typed.html#countParameters"><span class="hs-identifier hs-var">countParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246974"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span id="local-6989586621679246977"><span class="annot"><span class="annottext">extraParameters :: [Type]
</span><a href="#local-6989586621679246977"><span class="hs-identifier hs-var hs-var">extraParameters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; [Type]
</span><a href="Language.Lambda.Typed.html#takeParameters"><span class="hs-identifier hs-var">takeParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679246979"><span class="hs-identifier hs-var">extraParametersCount</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246975"><span class="hs-identifier hs-var">wholeType</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621679246976"><span class="annot"><span class="annottext">remainingType :: Type
</span><a href="#local-6989586621679246976"><span class="hs-identifier hs-var hs-var">remainingType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; Type
</span><a href="Language.Lambda.Typed.html#dropParameters"><span class="hs-identifier hs-var">dropParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679246979"><span class="hs-identifier hs-var">extraParametersCount</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679246975"><span class="hs-identifier hs-var">wholeType</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">newtype</span><span> </span><span id="Variable"><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-var">Variable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Variable"><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-var">Variable</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679246982"><span id="local-6989586621679246987"><span class="annot"><span class="annottext">Variable -&gt; Variable -&gt; Bool
(Variable -&gt; Variable -&gt; Bool)
-&gt; (Variable -&gt; Variable -&gt; Bool) -&gt; Eq Variable
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Variable -&gt; Variable -&gt; Bool
== :: Variable -&gt; Variable -&gt; Bool
$c/= :: Variable -&gt; Variable -&gt; Bool
/= :: Variable -&gt; Variable -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679246992"><span id="local-6989586621679246997"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-75"></span><span>  </span><span id="local-6989586621679246999"><span class="annot"><span class="annottext">show :: Variable -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span id="local-6989586621679247000"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247000"><span class="hs-identifier hs-var">variable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247000"><span class="hs-identifier hs-var">variable</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-keyword">newtype</span><span> </span><span id="Metavariable"><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-var">Metavariable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Metavariable"><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-var">Metavariable</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247003"><span id="local-6989586621679247008"><span class="annot"><span class="annottext">Metavariable -&gt; Metavariable -&gt; Bool
(Metavariable -&gt; Metavariable -&gt; Bool)
-&gt; (Metavariable -&gt; Metavariable -&gt; Bool) -&gt; Eq Metavariable
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Metavariable -&gt; Metavariable -&gt; Bool
== :: Metavariable -&gt; Metavariable -&gt; Bool
$c/= :: Metavariable -&gt; Metavariable -&gt; Bool
/= :: Metavariable -&gt; Metavariable -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679247014"><span id="local-6989586621679247019"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621679247021"><span class="annot"><span class="annottext">show :: Metavariable -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span> </span><span id="local-6989586621679247022"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247022"><span class="hs-identifier hs-var">metavariable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247022"><span class="hs-identifier hs-var">metavariable</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">data</span><span> </span><span id="Atom"><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="AVar"><span class="annot"><a href="Language.Lambda.Typed.html#AVar"><span class="hs-identifier hs-var">AVar</span></a></span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="AMetavar"><span class="annot"><a href="Language.Lambda.Typed.html#AMetavar"><span class="hs-identifier hs-var">AMetavar</span></a></span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247026"><span id="local-6989586621679247030"><span class="annot"><span class="annottext">Atom -&gt; Atom -&gt; Bool
(Atom -&gt; Atom -&gt; Bool) -&gt; (Atom -&gt; Atom -&gt; Bool) -&gt; Eq Atom
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Atom -&gt; Atom -&gt; Bool
== :: Atom -&gt; Atom -&gt; Bool
$c/= :: Atom -&gt; Atom -&gt; Bool
/= :: Atom -&gt; Atom -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679247033"><span id="local-6989586621679247038"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679247042"><span class="annot"><span class="annottext">show :: Atom -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#AVar"><span class="hs-identifier hs-type">AVar</span></a></span><span> </span><span id="local-6989586621679247043"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247043"><span class="hs-identifier hs-var">variable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Variable -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247043"><span class="hs-identifier hs-var">variable</span></a></span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#AMetavar"><span class="hs-identifier hs-type">AMetavar</span></a></span><span> </span><span id="local-6989586621679247044"><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247044"><span class="hs-identifier hs-var">metavariable</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Metavariable -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247044"><span class="hs-identifier hs-var">metavariable</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">data</span><span> </span><span id="Expression"><span class="annot"><a href="Language.Lambda.Typed.html#Expression"><span class="hs-identifier hs-var">Expression</span></a></span></span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Atom"><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Application"><span class="annot"><a href="Language.Lambda.Typed.html#Application"><span class="hs-identifier hs-var">Application</span></a></span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Lambda"><span class="annot"><a href="Language.Lambda.Typed.html#Lambda"><span class="hs-identifier hs-var">Lambda</span></a></span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247049"><span id="local-6989586621679247058"><span class="annot"><span class="annottext">Expression -&gt; Expression -&gt; Bool
(Expression -&gt; Expression -&gt; Bool)
-&gt; (Expression -&gt; Expression -&gt; Bool) -&gt; Eq Expression
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Expression -&gt; Expression -&gt; Bool
== :: Expression -&gt; Expression -&gt; Bool
$c/= :: Expression -&gt; Expression -&gt; Bool
/= :: Expression -&gt; Expression -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247061"><span id="local-6989586621679247073"><span id="local-6989586621679247076"><span class="annot"><span class="annottext">Int -&gt; Expression -&gt; ShowS
[Expression] -&gt; ShowS
Expression -&gt; String
(Int -&gt; Expression -&gt; ShowS)
-&gt; (Expression -&gt; String)
-&gt; ([Expression] -&gt; ShowS)
-&gt; Show Expression
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Expression -&gt; ShowS
showsPrec :: Int -&gt; Expression -&gt; ShowS
$cshow :: Expression -&gt; String
show :: Expression -&gt; String
$cshowList :: [Expression] -&gt; ShowS
showList :: [Expression] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span>
</span><span id="line-98"></span><span class="hs-keyword">pattern</span><span> </span><span id="Var"><span id="%24mVar"><span id="%24bVar"><span class="annot"><span class="annottext">$mVar :: forall {r}. Expression -&gt; (Variable -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bVar :: Variable -&gt; Expression
</span><a href="Language.Lambda.Typed.html#Var"><span class="hs-identifier hs-var hs-var hs-var">Var</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679247080"><span class="hs-identifier hs-type">variable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#AVar"><span class="hs-identifier hs-type">AVar</span></a></span><span> </span><span id="local-6989586621679247080"><span class="annot"><a href="#local-6989586621679247080"><span class="hs-identifier hs-var">variable</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavar"><span class="hs-identifier hs-type">Metavar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span>
</span><span id="line-101"></span><span class="hs-keyword">pattern</span><span> </span><span id="Metavar"><span id="%24mMetavar"><span id="%24bMetavar"><span class="annot"><span class="annottext">$mMetavar :: forall {r}. Expression -&gt; (Metavariable -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bMetavar :: Metavariable -&gt; Expression
</span><a href="Language.Lambda.Typed.html#Metavar"><span class="hs-identifier hs-var hs-var hs-var">Metavar</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679247083"><span class="hs-identifier hs-type">variable</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#AMetavar"><span class="hs-identifier hs-type">AMetavar</span></a></span><span> </span><span id="local-6989586621679247083"><span class="annot"><a href="#local-6989586621679247083"><span class="hs-identifier hs-var">variable</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- &gt;&gt;&gt; t = Base &quot;t&quot;</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- &gt;&gt;&gt; u = Base &quot;u&quot;</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- &gt;&gt;&gt; x = Variable &quot;x&quot;</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- &gt;&gt;&gt; y = Variable &quot;y&quot;</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOf (const (Just t)) (Var x)</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- Just t</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOf (const Nothing) (Lambda x t (Var x))</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- Just t -&gt; t</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOf (const (Just u)) (Lambda x t (Var y))</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- Just t -&gt; u</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOf (const (Just t)) (Application (Lambda x t (Var x)) (Var x))</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- Just t</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOf (const (Just u)) (Application (Lambda x t (Var x)) (Var x))</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-118"></span><span class="annot"><a href="Language.Lambda.Typed.html#typeOf"><span class="hs-identifier hs-type">typeOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-119"></span><span id="typeOf"><span class="annot"><span class="annottext">typeOf :: (Atom -&gt; Maybe Type) -&gt; Expression -&gt; Maybe Type
</span><a href="Language.Lambda.Typed.html#typeOf"><span class="hs-identifier hs-var hs-var">typeOf</span></a></span></span><span> </span><span id="local-6989586621679247084"><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247084"><span class="hs-identifier hs-var">typeOfAtom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span> </span><span id="local-6989586621679247085"><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247085"><span class="hs-identifier hs-var">atom</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247084"><span class="hs-identifier hs-var">typeOfAtom</span></a></span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247085"><span class="hs-identifier hs-var">atom</span></a></span><span>
</span><span id="line-120"></span><span class="annot"><a href="Language.Lambda.Typed.html#typeOf"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span id="local-6989586621679247086"><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247086"><span class="hs-identifier hs-var">typeOfAtom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679247087"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247087"><span class="hs-identifier hs-var">function</span></a></span></span><span> </span><span id="local-6989586621679247088"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247088"><span class="hs-identifier hs-var">argument</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679247089"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247089"><span class="hs-identifier hs-var">functionType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Atom -&gt; Maybe Type) -&gt; Expression -&gt; Maybe Type
</span><a href="Language.Lambda.Typed.html#typeOf"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247086"><span class="hs-identifier hs-var">typeOfAtom</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247087"><span class="hs-identifier hs-var">function</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679247090"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247090"><span class="hs-identifier hs-var">argumentType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Atom -&gt; Maybe Type) -&gt; Expression -&gt; Maybe Type
</span><a href="Language.Lambda.Typed.html#typeOf"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247086"><span class="hs-identifier hs-var">typeOfAtom</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247088"><span class="hs-identifier hs-var">argument</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247089"><span class="hs-identifier hs-var">functionType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="Language.Lambda.Typed.html#Function"><span class="hs-identifier hs-type">Function</span></a></span><span> </span><span id="local-6989586621679247091"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247091"><span class="hs-identifier hs-var">argumentType'</span></a></span></span><span> </span><span id="local-6989586621679247092"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247092"><span class="hs-identifier hs-var">returnType</span></a></span></span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247090"><span class="hs-identifier hs-var">argumentType</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247091"><span class="hs-identifier hs-var">argumentType'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247092"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Type
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Language.Lambda.Typed.html#typeOf"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span id="local-6989586621679247093"><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247093"><span class="hs-identifier hs-var">typeOfAtom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679247094"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247094"><span class="hs-identifier hs-var">boundVariable</span></a></span></span><span> </span><span id="local-6989586621679247095"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247095"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span id="local-6989586621679247096"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247096"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-128"></span><span>  </span><span id="local-6989586621679247097"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247097"><span class="hs-identifier hs-var">returnType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Atom -&gt; Maybe Type) -&gt; Expression -&gt; Maybe Type)
-&gt; Expression -&gt; (Atom -&gt; Maybe Type) -&gt; Maybe Type
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Atom -&gt; Maybe Type) -&gt; Expression -&gt; Maybe Type
</span><a href="Language.Lambda.Typed.html#typeOf"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247096"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">((Atom -&gt; Maybe Type) -&gt; Maybe Type)
-&gt; (Atom -&gt; Maybe Type) -&gt; Maybe Type
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679247099"><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247099"><span class="hs-identifier hs-var">variable</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247099"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="annot"><span class="annottext">Atom -&gt; Atom -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Variable -&gt; Atom
</span><a href="Language.Lambda.Typed.html#AVar"><span class="hs-identifier hs-var">AVar</span></a></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247094"><span class="hs-identifier hs-var">boundVariable</span></a></span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247095"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-131"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247093"><span class="hs-identifier hs-var">typeOfAtom</span></a></span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247099"><span class="hs-identifier hs-var">variable</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Language.Lambda.Typed.html#Function"><span class="hs-identifier hs-var">Function</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247095"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247097"><span class="hs-identifier hs-var">returnType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-keyword">data</span><span> </span><span id="Heading"><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span></span><span> </span><span id="local-6989586621679246740"><span class="annot"><a href="#local-6989586621679246740"><span class="hs-identifier hs-type">head</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Heading"><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span></span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="binder"><span class="annot"><span class="annottext">forall head. Heading head -&gt; [(Variable, Type)]
</span><a href="Language.Lambda.Typed.html#binder"><span class="hs-identifier hs-var hs-var">binder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="head"><span class="annot"><span class="annottext">forall head. Heading head -&gt; head
</span><a href="Language.Lambda.Typed.html#head"><span class="hs-identifier hs-var hs-var">head</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679246740"><span class="hs-identifier hs-type">head</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247105"><span id="local-6989586621679247110"><span class="annot"><span class="annottext">Heading head -&gt; Heading head -&gt; Bool
(Heading head -&gt; Heading head -&gt; Bool)
-&gt; (Heading head -&gt; Heading head -&gt; Bool) -&gt; Eq (Heading head)
forall head. Eq head =&gt; Heading head -&gt; Heading head -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall head. Eq head =&gt; Heading head -&gt; Heading head -&gt; Bool
== :: Heading head -&gt; Heading head -&gt; Bool
$c/= :: forall head. Eq head =&gt; Heading head -&gt; Heading head -&gt; Bool
/= :: Heading head -&gt; Heading head -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679246749"><span id="local-6989586621679247116"><span id="local-6989586621679247121"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679246749"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246749"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679247125"><span class="annot"><span class="annottext">show :: Heading head -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247126"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247126"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span id="local-6989586621679247127"><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679247127"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247128"><span class="hs-identifier hs-var">binder'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">head -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679247127"><span class="hs-identifier hs-var">head</span></a></span><span>
</span><span id="line-142"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679247128"><span class="annot"><span class="annottext">binder' :: String
</span><a href="#local-6989586621679247128"><span class="hs-identifier hs-var hs-var">binder'</span></a></span></span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247126"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#955;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Variable, Type) -&gt; String) -&gt; [(Variable, Type)] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Variable, Type) -&gt; String
forall {a} {a}. (Show a, Show a) =&gt; (a, a) -&gt; String
</span><a href="#local-6989586621679247136"><span class="hs-identifier hs-var">showParameter</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247126"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. &quot;</span></span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679247136"><span class="annot"><span class="annottext">showParameter :: (a, a) -&gt; String
</span><a href="#local-6989586621679247136"><span class="hs-identifier hs-var hs-var">showParameter</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247143"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247143"><span class="hs-identifier hs-var">variable</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247144"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247144"><span class="hs-identifier hs-var">typ</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247143"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247144"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- Ignores types of parameters (at least for now).</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- &gt;&gt;&gt; a = Variable &quot;a&quot;</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- &gt;&gt;&gt; x = Variable &quot;x&quot;</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- &gt;&gt;&gt; y = Variable &quot;y&quot;</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- &gt;&gt;&gt; t = Base &quot;t&quot;</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- &gt;&gt;&gt; areAlphaEquivalent (Heading [(x, t)] x) (Heading [(y, t)] y)</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- &gt;&gt;&gt; areAlphaEquivalent (Heading [(x, t)] a) (Heading [(y, t)] a)</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- True</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- &gt;&gt;&gt; areAlphaEquivalent (Heading [(x, t)] x) (Heading [(y, t)] x)</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- &gt;&gt;&gt; areAlphaEquivalent (Heading [(y, t)] x) (Heading [(x, t)] x)</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- &gt;&gt;&gt; areAlphaEquivalent (Heading [(x, t), (y, t)] x) (Heading [(x, t)] x)</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- False</span><span>
</span><span id="line-165"></span><span class="annot"><a href="Language.Lambda.Typed.html#areAlphaEquivalent"><span class="hs-identifier hs-type">areAlphaEquivalent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-166"></span><span id="areAlphaEquivalent"><span class="annot"><span class="annottext">areAlphaEquivalent :: Heading Variable -&gt; Heading Variable -&gt; Bool
</span><a href="Language.Lambda.Typed.html#areAlphaEquivalent"><span class="hs-identifier hs-var hs-var">areAlphaEquivalent</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679247146"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247146"><span class="hs-identifier hs-var">leftHead</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679247147"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247147"><span class="hs-identifier hs-var">rightHead</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247146"><span class="hs-identifier hs-var">leftHead</span></a></span><span> </span><span class="annot"><span class="annottext">Variable -&gt; Variable -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247147"><span class="hs-identifier hs-var">rightHead</span></a></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Language.Lambda.Typed.html#areAlphaEquivalent"><span class="hs-identifier hs-var">areAlphaEquivalent</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679247148"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247148"><span class="hs-identifier hs-var">leftVariable</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247149"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247149"><span class="hs-identifier hs-var">leftBinder</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247150"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247150"><span class="hs-identifier hs-var">leftHead</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679247151"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247151"><span class="hs-identifier hs-var">rightVariable</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247152"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247152"><span class="hs-identifier hs-var">rightBinder</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247153"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247153"><span class="hs-identifier hs-var">rightHead</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247148"><span class="hs-identifier hs-var">leftVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Variable -&gt; Variable -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247150"><span class="hs-identifier hs-var">leftHead</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247151"><span class="hs-identifier hs-var">rightVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Variable -&gt; Variable -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247153"><span class="hs-identifier hs-var">rightHead</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247149"><span class="hs-identifier hs-var">leftBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247152"><span class="hs-identifier hs-var">rightBinder</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247151"><span class="hs-identifier hs-var">rightVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Variable -&gt; Variable -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247153"><span class="hs-identifier hs-var">rightHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>        </span><span class="annot"><span class="annottext">Heading Variable -&gt; Heading Variable -&gt; Bool
</span><a href="Language.Lambda.Typed.html#areAlphaEquivalent"><span class="hs-identifier hs-var">areAlphaEquivalent</span></a></span><span>
</span><span id="line-176"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Variable -&gt; Heading Variable
forall head. [(Variable, Type)] -&gt; head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247149"><span class="hs-identifier hs-var">leftBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247150"><span class="hs-identifier hs-var">leftHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Variable -&gt; Heading Variable
forall head. [(Variable, Type)] -&gt; head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247152"><span class="hs-identifier hs-var">rightBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247153"><span class="hs-identifier hs-var">rightHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span class="annot"><a href="Language.Lambda.Typed.html#areAlphaEquivalent"><span class="hs-identifier hs-var">areAlphaEquivalent</span></a></span><span> </span><span class="annot"><span class="annottext">Heading Variable
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Heading Variable
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- &gt;&gt;&gt; x = Variable &quot;x&quot;</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- &gt;&gt;&gt; y = Variable &quot;y&quot;</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- &gt;&gt;&gt; t = Base &quot;t&quot;</span><span>
</span><span id="line-183"></span><span class="hs-comment">--</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- &gt;&gt;&gt; imitatableHead (Heading [] x) 0</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- Just (Right (Variable &quot;x&quot;))</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- &gt;&gt;&gt; imitatableHead (Heading [(y, t)] x) 0</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- Just (Right (Variable &quot;x&quot;))</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- &gt;&gt;&gt; imitatableHead (Heading [(y, t)] y) 0</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- Just (Left 0)</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- &gt;&gt;&gt; imitatableHead (Heading [(x, t), (y, t)] y) 0</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- Just (Left 1)</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- &gt;&gt;&gt; imitatableHead (Heading [(x, t), (y, t)] y) 1</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- Just (Left 0)</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- &gt;&gt;&gt; imitatableHead (Heading [(y, t)] y) 1</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-196"></span><span class="annot"><a href="Language.Lambda.Typed.html#imitatableHead"><span class="hs-identifier hs-type">imitatableHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span id="imitatableHead"><span class="annot"><span class="annottext">imitatableHead :: Heading Variable -&gt; Int -&gt; Maybe (Either Int Variable)
</span><a href="Language.Lambda.Typed.html#imitatableHead"><span class="hs-identifier hs-var hs-var">imitatableHead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679247157"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247157"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Int Variable -&gt; Maybe (Either Int Variable)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Variable -&gt; Either Int Variable
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247157"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span class="annot"><a href="Language.Lambda.Typed.html#imitatableHead"><span class="hs-identifier hs-var">imitatableHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679247158"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247158"><span class="hs-identifier hs-var">variable</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247159"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247159"><span class="hs-identifier hs-var">binder</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247160"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247160"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247161"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247161"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247158"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="annot"><span class="annottext">Variable -&gt; Variable -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247160"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247161"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either Int Variable -&gt; Maybe (Either Int Variable)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Either Int Variable
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247161"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247158"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="annot"><span class="annottext">Variable -&gt; Variable -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247160"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Either Int Variable)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Heading Variable -&gt; Int -&gt; Maybe (Either Int Variable)
</span><a href="Language.Lambda.Typed.html#imitatableHead"><span class="hs-identifier hs-var">imitatableHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Variable -&gt; Heading Variable
forall head. [(Variable, Type)] -&gt; head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247159"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247160"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247161"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-keyword">data</span><span> </span><span id="NormalTerm%27"><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-var">NormalTerm'</span></a></span></span><span> </span><span id="local-6989586621679246761"><span class="annot"><a href="#local-6989586621679246761"><span class="hs-identifier hs-type">head</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NormalTerm"><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-var">NormalTerm</span></a></span></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="heading"><span class="annot"><span class="annottext">forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var hs-var">heading</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246761"><span class="hs-identifier hs-type">head</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="arguments"><span class="annot"><span class="annottext">forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-identifier hs-var hs-var">arguments</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="returnType"><span class="annot"><span class="annottext">forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#returnType"><span class="hs-identifier hs-var hs-var">returnType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247168"><span id="local-6989586621679247174"><span class="annot"><span class="annottext">NormalTerm' head -&gt; NormalTerm' head -&gt; Bool
(NormalTerm' head -&gt; NormalTerm' head -&gt; Bool)
-&gt; (NormalTerm' head -&gt; NormalTerm' head -&gt; Bool)
-&gt; Eq (NormalTerm' head)
forall head.
Eq head =&gt;
NormalTerm' head -&gt; NormalTerm' head -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall head.
Eq head =&gt;
NormalTerm' head -&gt; NormalTerm' head -&gt; Bool
== :: NormalTerm' head -&gt; NormalTerm' head -&gt; Bool
$c/= :: forall head.
Eq head =&gt;
NormalTerm' head -&gt; NormalTerm' head -&gt; Bool
/= :: NormalTerm' head -&gt; NormalTerm' head -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679246769"><span id="local-6989586621679247179"><span id="local-6989586621679247184"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679246769"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-type">NormalTerm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246769"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621679247191"><span class="annot"><span class="annottext">show :: NormalTerm' head -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span id="local-6989586621679247192"><span class="annot"><span class="annottext">Heading head
</span><a href="#local-6989586621679247192"><span class="hs-identifier hs-var">heading</span></a></span></span><span> </span><span id="local-6989586621679247193"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247193"><span class="hs-identifier hs-var">arguments</span></a></span></span><span> </span><span id="local-6989586621679247194"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247194"><span class="hs-identifier hs-var">returnType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">Heading head -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Heading head
</span><a href="#local-6989586621679247192"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247195"><span class="hs-identifier hs-var">arguments'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; :: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247194"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-213"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679247195"><span class="annot"><span class="annottext">arguments' :: String
</span><a href="#local-6989586621679247195"><span class="hs-identifier hs-var hs-var">arguments'</span></a></span></span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">[NormalTerm] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247193"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NormalTerm -&gt; String) -&gt; [NormalTerm] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679247204"><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247204"><span class="hs-identifier hs-var">argument</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">NormalTerm -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247204"><span class="hs-identifier hs-var">argument</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247193"><span class="hs-identifier hs-var">arguments</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-keyword">type</span><span> </span><span id="NormalTerm"><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-var">NormalTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-type">NormalTerm'</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span>
</span><span id="line-219"></span><span class="hs-keyword">type</span><span> </span><span id="RigidTerm"><span class="annot"><a href="Language.Lambda.Typed.html#RigidTerm"><span class="hs-identifier hs-var">RigidTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-type">NormalTerm'</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span>
</span><span id="line-220"></span><span class="hs-keyword">type</span><span> </span><span id="FlexibleTerm"><span class="annot"><a href="Language.Lambda.Typed.html#FlexibleTerm"><span class="hs-identifier hs-var">FlexibleTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-type">NormalTerm'</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679246771"><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679246771"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-type">NormalTerm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246771"><span class="hs-identifier hs-type">head</span></a></span></span><span>
</span><span id="line-223"></span><span class="hs-keyword">pattern</span><span> </span><span id="Term"><span id="%24mTerm"><span id="%24bTerm"><span class="annot"><span class="annottext">$mTerm :: forall {r} {head}.
NormalTerm' head
-&gt; ([(Variable, Type)] -&gt; head -&gt; [NormalTerm] -&gt; Type -&gt; r)
-&gt; ((# #) -&gt; r)
-&gt; r
$bTerm :: forall head.
[(Variable, Type)]
-&gt; head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#Term"><span class="hs-identifier hs-var hs-var hs-var">Term</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679247208"><span class="hs-identifier hs-type">binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247209"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247210"><span class="hs-identifier hs-type">arguments</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247211"><span class="hs-identifier hs-type">returnType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247208"><span class="annot"><a href="#local-6989586621679247208"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span id="local-6989586621679247209"><span class="annot"><a href="#local-6989586621679247209"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247210"><span class="annot"><a href="#local-6989586621679247210"><span class="hs-identifier hs-var">arguments</span></a></span></span><span> </span><span id="local-6989586621679247211"><span class="annot"><a href="#local-6989586621679247211"><span class="hs-identifier hs-var">returnType</span></a></span></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span id="local-6989586621679246774"><span class="annot"><a href="Language.Lambda.Typed.html#apply"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679246774"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-type">NormalTerm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246774"><span class="hs-identifier hs-type">head</span></a></span></span><span>
</span><span id="line-226"></span><span id="apply"><span class="annot"><span class="annottext">apply :: forall head. head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#apply"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
-&gt; head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
forall head.
[(Variable, Type)]
-&gt; head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#Term"><span class="hs-identifier hs-var">Term</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span id="local-6989586621679246776"><span class="annot"><a href="Language.Lambda.Typed.html#var"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679246776"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-type">NormalTerm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246776"><span class="hs-identifier hs-type">head</span></a></span></span><span>
</span><span id="line-229"></span><span id="var"><span class="annot"><span class="annottext">var :: forall head. head -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#var"><span class="hs-identifier hs-var hs-var">var</span></a></span></span><span> </span><span id="local-6989586621679247214"><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679247214"><span class="hs-identifier hs-var">head</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
forall head. head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679247214"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="annot"><a href="Language.Lambda.Typed.html#termKind"><span class="hs-identifier hs-type">termKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#FlexibleTerm"><span class="hs-identifier hs-type">FlexibleTerm</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#RigidTerm"><span class="hs-identifier hs-type">RigidTerm</span></a></span><span>
</span><span id="line-232"></span><span id="termKind"><span class="annot"><span class="annottext">termKind :: NormalTerm -&gt; Either FlexibleTerm RigidTerm
</span><a href="Language.Lambda.Typed.html#termKind"><span class="hs-identifier hs-var hs-var">termKind</span></a></span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247216"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247216"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#AVar"><span class="hs-identifier hs-type">AVar</span></a></span><span> </span><span id="local-6989586621679247217"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247217"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247218"><span id="local-6989586621679247219"><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: forall head. NormalTerm' head -&gt; [NormalTerm]
returnType :: forall head. NormalTerm' head -&gt; Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="annottext">RigidTerm -&gt; Either FlexibleTerm RigidTerm
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: Heading Variable
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Variable -&gt; Heading Variable
forall head. [(Variable, Type)] -&gt; head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247216"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247217"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: [NormalTerm]
returnType :: Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span class="annot"><a href="Language.Lambda.Typed.html#termKind"><span class="hs-identifier hs-var">termKind</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247220"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247220"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#AMetavar"><span class="hs-identifier hs-type">AMetavar</span></a></span><span> </span><span id="local-6989586621679247221"><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247221"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247222"><span id="local-6989586621679247223"><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: forall head. NormalTerm' head -&gt; [NormalTerm]
returnType :: forall head. NormalTerm' head -&gt; Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">FlexibleTerm -&gt; Either FlexibleTerm RigidTerm
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: Heading Metavariable
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Metavariable -&gt; Heading Metavariable
forall head. [(Variable, Type)] -&gt; head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247220"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247221"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: [NormalTerm]
returnType :: Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Rigid"><span class="hs-identifier hs-type">Rigid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#RigidTerm"><span class="hs-identifier hs-type">RigidTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span>
</span><span id="line-238"></span><span class="hs-keyword">pattern</span><span> </span><span id="Rigid"><span id="%24mRigid"><span id="%24bRigid"><span class="annot"><span class="annottext">$mRigid :: forall {r}. NormalTerm -&gt; (RigidTerm -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bRigid :: RigidTerm -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#Rigid"><span class="hs-identifier hs-var hs-var hs-var hs-var">Rigid</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679247227"><span class="hs-identifier hs-type">rigid</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#termKind"><span class="hs-identifier hs-type">termKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679247227"><span class="annot"><a href="#local-6989586621679247227"><span class="hs-identifier hs-var">rigid</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><a href="Language.Lambda.Typed.html#Rigid"><span class="hs-identifier hs-var">Rigid</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247228"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247228"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span id="local-6989586621679247229"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247229"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247230"><span id="local-6989586621679247231"><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: forall head. NormalTerm' head -&gt; [NormalTerm]
returnType :: forall head. NormalTerm' head -&gt; Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: Heading Atom
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Atom -&gt; Heading Atom
forall head. [(Variable, Type)] -&gt; head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247228"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Variable -&gt; Atom
</span><a href="Language.Lambda.Typed.html#AVar"><span class="hs-identifier hs-var">AVar</span></a></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247229"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: [NormalTerm]
returnType :: Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#FlexibleTerm"><span class="hs-identifier hs-type">FlexibleTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span>
</span><span id="line-244"></span><span class="hs-keyword">pattern</span><span> </span><span id="Flexible"><span id="%24mFlexible"><span id="%24bFlexible"><span class="annot"><span class="annottext">$mFlexible :: forall {r}. NormalTerm -&gt; (FlexibleTerm -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bFlexible :: FlexibleTerm -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#Flexible"><span class="hs-identifier hs-var hs-var hs-var hs-var">Flexible</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679247235"><span class="hs-identifier hs-type">flexible</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#termKind"><span class="hs-identifier hs-type">termKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679247235"><span class="annot"><a href="#local-6989586621679247235"><span class="hs-identifier hs-var">flexible</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="Language.Lambda.Typed.html#Flexible"><span class="hs-identifier hs-var">Flexible</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247236"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247236"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span id="local-6989586621679247237"><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247237"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247238"><span id="local-6989586621679247239"><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: forall head. NormalTerm' head -&gt; [NormalTerm]
returnType :: forall head. NormalTerm' head -&gt; Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: Heading Atom
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Atom -&gt; Heading Atom
forall head. [(Variable, Type)] -&gt; head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247236"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Metavariable -&gt; Atom
</span><a href="Language.Lambda.Typed.html#AMetavar"><span class="hs-identifier hs-var">AMetavar</span></a></span><span> </span><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247237"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: [NormalTerm]
returnType :: Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">-- &gt;&gt;&gt; x = Variable &quot;x&quot;</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- &gt;&gt;&gt; y = Variable &quot;y&quot;</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- &gt;&gt;&gt; z = Variable &quot;z&quot;</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- &gt;&gt;&gt; t = Base &quot;t&quot;</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOfAtom var = if var == AVar x then Just (Function t (Function t t)) else Just t</span><span>
</span><span id="line-254"></span><span class="hs-comment">--</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- &gt;&gt;&gt; asNormalTerm typeOfAtom (Var x)</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- Just x :: t -&gt; t -&gt; t</span><span>
</span><span id="line-257"></span><span class="hs-comment">--</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- &gt;&gt;&gt; asNormalTerm typeOfAtom (Application (Var x) (Var y))</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- Just x (y :: t) :: t -&gt; t</span><span>
</span><span id="line-260"></span><span class="hs-comment">--</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- &gt;&gt;&gt; asNormalTerm typeOfAtom (Application (Application (Var x) (Var y)) (Var z))</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- Just x (y :: t) (z :: t) :: t</span><span>
</span><span id="line-263"></span><span class="hs-comment">--</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- &gt;&gt;&gt; asNormalTerm typeOfAtom (Lambda z t (Var x))</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- Just &#955;z: t. x :: t -&gt; t -&gt; t</span><span>
</span><span id="line-266"></span><span class="hs-comment">--</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- &gt;&gt;&gt; asNormalTerm typeOfAtom (Lambda y t (Lambda z t (Var x)))</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- Just &#955;y: t, z: t. x :: t -&gt; t -&gt; t</span><span>
</span><span id="line-269"></span><span class="hs-comment">--</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- &gt;&gt;&gt; asNormalTerm typeOfAtom (Lambda z t (Application (Var x) (Var y)))</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- Just &#955;z: t. x (y :: t) :: t -&gt; t</span><span>
</span><span id="line-272"></span><span class="hs-comment">--</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- &gt;&gt;&gt; asNormalTerm typeOfAtom (Application (Lambda x t (Var x)) (Var y))</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-275"></span><span class="hs-comment">--</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- &gt;&gt;&gt; asNormalTerm typeOfAtom (Lambda x t (Application (Lambda z t (Var z)) (Var y)))</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-278"></span><span class="annot"><a href="Language.Lambda.Typed.html#asNormalTerm"><span class="hs-identifier hs-type">asNormalTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Expression"><span class="hs-identifier hs-type">Expression</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span>
</span><span id="line-279"></span><span id="asNormalTerm"><span class="annot"><span class="annottext">asNormalTerm :: (Atom -&gt; Maybe Type) -&gt; Expression -&gt; Maybe NormalTerm
</span><a href="Language.Lambda.Typed.html#asNormalTerm"><span class="hs-identifier hs-var hs-var">asNormalTerm</span></a></span></span><span> </span><span id="local-6989586621679247240"><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247240"><span class="hs-identifier hs-var">typeOfAtom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621679247241"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247241"><span class="hs-identifier hs-var">parameter</span></a></span></span><span> </span><span id="local-6989586621679247242"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247242"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span id="local-6989586621679247243"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247243"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247245"><span class="annot"><span class="annottext">typeOfAtom' :: Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247245"><span class="hs-identifier hs-var hs-var">typeOfAtom'</span></a></span></span><span> </span><span id="local-6989586621679247246"><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247246"><span class="hs-identifier hs-var">variable</span></a></span></span><span>
</span><span id="line-281"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247246"><span class="hs-identifier hs-var">variable</span></a></span><span> </span><span class="annot"><span class="annottext">Atom -&gt; Atom -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Variable -&gt; Atom
</span><a href="Language.Lambda.Typed.html#AVar"><span class="hs-identifier hs-var">AVar</span></a></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247241"><span class="hs-identifier hs-var">parameter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Maybe Type
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247242"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247240"><span class="hs-identifier hs-var">typeOfAtom</span></a></span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247246"><span class="hs-identifier hs-var">variable</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247247"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247247"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span id="local-6989586621679247248"><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247248"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247249"><span id="local-6989586621679247250"><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: forall head. NormalTerm' head -&gt; [NormalTerm]
returnType :: forall head. NormalTerm' head -&gt; Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Atom -&gt; Maybe Type) -&gt; Expression -&gt; Maybe NormalTerm
</span><a href="Language.Lambda.Typed.html#asNormalTerm"><span class="hs-identifier hs-var">asNormalTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247245"><span class="hs-identifier hs-var">typeOfAtom'</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247243"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span class="annot"><span class="annottext">NormalTerm -&gt; Maybe NormalTerm
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: Heading Atom
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Atom -&gt; Heading Atom
forall head. [(Variable, Type)] -&gt; head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247241"><span class="hs-identifier hs-var">parameter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247242"><span class="hs-identifier hs-var">typ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Variable, Type) -&gt; [(Variable, Type)] -&gt; [(Variable, Type)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247247"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247248"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: [NormalTerm]
returnType :: Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span class="annot"><a href="Language.Lambda.Typed.html#asNormalTerm"><span class="hs-identifier hs-var">asNormalTerm</span></a></span><span> </span><span id="local-6989586621679247251"><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247251"><span class="hs-identifier hs-var">typeOfAtom</span></a></span></span><span> </span><span id="local-6989586621679247252"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247252"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679247253"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247253"><span class="hs-identifier hs-var">returnType</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Atom -&gt; Maybe Type) -&gt; Expression -&gt; Maybe Type
</span><a href="Language.Lambda.Typed.html#typeOf"><span class="hs-identifier hs-var">typeOf</span></a></span><span> </span><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247251"><span class="hs-identifier hs-var">typeOfAtom</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247252"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679247254"><span class="annot"><span class="annottext">Heading Atom
</span><a href="#local-6989586621679247254"><span class="hs-identifier hs-var">heading</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247255"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247255"><span class="hs-identifier hs-var">arguments</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Maybe (Heading Atom, [NormalTerm])
</span><a href="#local-6989586621679247256"><span class="hs-identifier hs-var">extractBody</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247252"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><span class="annottext">NormalTerm -&gt; Maybe NormalTerm
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Heading Atom -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm
forall head.
Heading head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-var">NormalTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Heading Atom
</span><a href="#local-6989586621679247254"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247255"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247253"><span class="hs-identifier hs-var">returnType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621679247256"><span class="annot"><span class="annottext">extractBody :: Expression -&gt; Maybe (Heading Atom, [NormalTerm])
</span><a href="#local-6989586621679247256"><span class="hs-identifier hs-var hs-var">extractBody</span></a></span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Heading Atom, [NormalTerm])
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><a href="#local-6989586621679247256"><span class="hs-identifier hs-var">extractBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Application"><span class="hs-identifier hs-type">Application</span></a></span><span> </span><span id="local-6989586621679247260"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247260"><span class="hs-identifier hs-var">function</span></a></span></span><span> </span><span id="local-6989586621679247261"><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247261"><span class="hs-identifier hs-var">argument</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679247262"><span class="annot"><span class="annottext">Heading Atom
</span><a href="#local-6989586621679247262"><span class="hs-identifier hs-var">heading</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247263"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247263"><span class="hs-identifier hs-var">arguments</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expression -&gt; Maybe (Heading Atom, [NormalTerm])
</span><a href="#local-6989586621679247256"><span class="hs-identifier hs-var">extractBody</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247260"><span class="hs-identifier hs-var">function</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621679247264"><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247264"><span class="hs-identifier hs-var">normalArgument</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Atom -&gt; Maybe Type) -&gt; Expression -&gt; Maybe NormalTerm
</span><a href="Language.Lambda.Typed.html#asNormalTerm"><span class="hs-identifier hs-var">asNormalTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Atom -&gt; Maybe Type
</span><a href="#local-6989586621679247251"><span class="hs-identifier hs-var">typeOfAtom</span></a></span><span> </span><span class="annot"><span class="annottext">Expression
</span><a href="#local-6989586621679247261"><span class="hs-identifier hs-var">argument</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="annottext">(Heading Atom, [NormalTerm]) -&gt; Maybe (Heading Atom, [NormalTerm])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Heading Atom
</span><a href="#local-6989586621679247262"><span class="hs-identifier hs-var">heading</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247263"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">[NormalTerm] -&gt; [NormalTerm] -&gt; [NormalTerm]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247264"><span class="hs-identifier hs-var">normalArgument</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>  </span><span class="annot"><a href="#local-6989586621679247256"><span class="hs-identifier hs-var">extractBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span> </span><span id="local-6989586621679247265"><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247265"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Heading Atom, [NormalTerm]) -&gt; Maybe (Heading Atom, [NormalTerm])
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Atom -&gt; Heading Atom
forall head. [(Variable, Type)] -&gt; head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247265"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span id="local-6989586621679247266"><span class="annot"><a href="Language.Lambda.Typed.html#scopedArguments"><span class="hs-identifier hs-type">scopedArguments</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-type">NormalTerm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247266"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-298"></span><span id="scopedArguments"><span class="annot"><span class="annottext">scopedArguments :: forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#scopedArguments"><span class="hs-identifier hs-var hs-var">scopedArguments</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247269"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247269"><span class="hs-identifier hs-var">scope</span></a></span></span><span> </span><span class="annot"><span class="annottext">head
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247270"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247270"><span class="hs-identifier hs-var">arguments</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><span class="annottext">NormalTerm -&gt; NormalTerm
forall {head}. NormalTerm' head -&gt; NormalTerm' head
</span><a href="#local-6989586621679247271"><span class="hs-identifier hs-var">scopedArgument</span></a></span><span> </span><span class="annot"><span class="annottext">(NormalTerm -&gt; NormalTerm) -&gt; [NormalTerm] -&gt; [NormalTerm]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247270"><span class="hs-identifier hs-var">arguments</span></a></span><span>
</span><span id="line-300"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>  </span><span id="local-6989586621679247271"><span class="annot"><span class="annottext">scopedArgument :: NormalTerm' head -&gt; NormalTerm' head
</span><a href="#local-6989586621679247271"><span class="hs-identifier hs-var hs-var">scopedArgument</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247274"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247274"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span id="local-6989586621679247275"><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679247275"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247276"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247276"><span class="hs-identifier hs-var">subarguments</span></a></span></span><span> </span><span id="local-6989586621679247277"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247277"><span class="hs-identifier hs-var">returnType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><span class="annottext">Heading head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
forall head.
Heading head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-var">NormalTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; head -&gt; Heading head
forall head. [(Variable, Type)] -&gt; head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247269"><span class="hs-identifier hs-var">scope</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; [(Variable, Type)] -&gt; [(Variable, Type)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247274"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679247275"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247276"><span class="hs-identifier hs-var">subarguments</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247277"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- &gt;&gt;&gt; x = Variable &quot;x&quot;</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- &gt;&gt;&gt; y = Variable &quot;y&quot;</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- &gt;&gt;&gt; t = Base &quot;t&quot;</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- &gt;&gt;&gt; u = Base &quot;u&quot;</span><span>
</span><span id="line-308"></span><span class="hs-comment">--</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOfTerm (NormalTerm (Heading [(x, t)] y) [] u)</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- t -&gt; u</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOfTerm (NormalTerm (Heading [(x, t), (y, u)] y) [] u)</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- t -&gt; u -&gt; u</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOfTerm (NormalTerm (Heading [(x, t)] y) [NormalTerm (Heading [] (AVar x)) [] u] u)</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- t -&gt; u</span><span>
</span><span id="line-315"></span><span id="local-6989586621679247278"><span class="annot"><a href="Language.Lambda.Typed.html#typeOfTerm"><span class="hs-identifier hs-type">typeOfTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-type">NormalTerm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247278"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-316"></span><span id="typeOfTerm"><span class="annot"><span class="annottext">typeOfTerm :: forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#typeOfTerm"><span class="hs-identifier hs-var hs-var">typeOfTerm</span></a></span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">head
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247280"><span class="annot"><span class="annottext">Type
returnType :: forall head. NormalTerm' head -&gt; Type
returnType :: Type
</span><a href="Language.Lambda.Typed.html#returnType"><span class="hs-identifier hs-var hs-var">returnType</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247280"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-317"></span><span class="annot"><a href="Language.Lambda.Typed.html#typeOfTerm"><span class="hs-identifier hs-var">typeOfTerm</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Variable
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247281"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247281"><span class="hs-identifier hs-var">parameterType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247282"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247282"><span class="hs-identifier hs-var">binder</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247283"><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679247283"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247284"><span id="local-6989586621679247285"><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: forall head. NormalTerm' head -&gt; [NormalTerm]
returnType :: forall head. NormalTerm' head -&gt; Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Language.Lambda.Typed.html#Function"><span class="hs-identifier hs-var">Function</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247281"><span class="hs-identifier hs-var">parameterType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalTerm' head -&gt; Type
forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#typeOfTerm"><span class="hs-identifier hs-var">typeOfTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">heading :: Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; head -&gt; Heading head
forall head. [(Variable, Type)] -&gt; head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-var">Heading</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247282"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679247283"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
Type
arguments :: [NormalTerm]
returnType :: Type
arguments :: [NormalTerm]
returnType :: Type
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span class="hs-comment">-- &gt;&gt;&gt; x = Variable &quot;x&quot;</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- &gt;&gt;&gt; y = Variable &quot;y&quot;</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- &gt;&gt;&gt; t = Base &quot;t&quot;</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- &gt;&gt;&gt; u = Base &quot;u&quot;</span><span>
</span><span id="line-324"></span><span class="hs-comment">--</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOfHead (NormalTerm (Heading [(x, t)] y) [] u)</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- u</span><span>
</span><span id="line-327"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOfHead (NormalTerm (Heading [(x, t), (y, u)] y) [] u)</span><span>
</span><span id="line-328"></span><span class="hs-comment">-- u</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- &gt;&gt;&gt; typeOfHead (NormalTerm (Heading [(x, t)] y) [NormalTerm (Heading [] (AVar x)) [] u] u)</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- u -&gt; u</span><span>
</span><span id="line-331"></span><span id="local-6989586621679247286"><span class="annot"><a href="Language.Lambda.Typed.html#typeOfHead"><span class="hs-identifier hs-type">typeOfHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-type">NormalTerm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247286"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span></span><span>
</span><span id="line-332"></span><span id="typeOfHead"><span class="annot"><span class="annottext">typeOfHead :: forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#typeOfHead"><span class="hs-identifier hs-var hs-var">typeOfHead</span></a></span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">arguments :: forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247288"><span class="annot"><span class="annottext">Type
returnType :: forall head. NormalTerm' head -&gt; Type
returnType :: Type
</span><a href="Language.Lambda.Typed.html#returnType"><span class="hs-identifier hs-var hs-var">returnType</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247288"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-333"></span><span class="annot"><a href="Language.Lambda.Typed.html#typeOfHead"><span class="hs-identifier hs-var">typeOfHead</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">arguments :: forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247289"><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247289"><span class="hs-identifier hs-var">argument</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247290"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247290"><span class="hs-identifier hs-var">arguments</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247291"><span id="local-6989586621679247292"><span class="annot"><span class="annottext">Heading head
Type
heading :: forall head. NormalTerm' head -&gt; Heading head
returnType :: forall head. NormalTerm' head -&gt; Type
heading :: Heading head
returnType :: Type
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Language.Lambda.Typed.html#Function"><span class="hs-identifier hs-var">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalTerm -&gt; Type
forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#typeOfTerm"><span class="hs-identifier hs-var">typeOfTerm</span></a></span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247289"><span class="hs-identifier hs-var">argument</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalTerm' head -&gt; Type
forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#typeOfHead"><span class="hs-identifier hs-var">typeOfHead</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">[NormalTerm]
arguments :: [NormalTerm]
arguments :: [NormalTerm]
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-identifier hs-var hs-var">arguments</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Heading head
Type
heading :: Heading head
returnType :: Type
heading :: Heading head
returnType :: Type
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-comment">-- &gt;&gt;&gt; t = Base &quot;t&quot;</span><span>
</span><span id="line-337"></span><span class="hs-comment">-- &gt;&gt;&gt; _M = AMetavar (Metavariable &quot;M&quot;)</span><span>
</span><span id="line-338"></span><span class="hs-comment">-- &gt;&gt;&gt; (a, a') = (AVar a', Variable &quot;a&quot;)</span><span>
</span><span id="line-339"></span><span class="hs-comment">-- &gt;&gt;&gt; (b, b') = (AVar b', Variable &quot;b&quot;)</span><span>
</span><span id="line-340"></span><span class="hs-comment">-- &gt;&gt;&gt; (x, x') = (AVar x', Variable &quot;x&quot;)</span><span>
</span><span id="line-341"></span><span class="hs-comment">--</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- &gt;&gt;&gt; substituteHead (Term [(x', t)] x [] t) (var _M t)</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- &#955;x: t. x :: t</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- &gt;&gt;&gt; substituteHead (var x t) (Term [(a', t)] _M [] t)</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- &#955;a: t. x :: t</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- &gt;&gt;&gt; substituteHead (Term [(a', t)] a [] t) (Term [(b', t)] _M [var x t] t)</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- &#955;b: t. x :: t</span><span>
</span><span id="line-348"></span><span id="local-6989586621679246793"><span class="annot"><a href="Language.Lambda.Typed.html#substituteHead"><span class="hs-identifier hs-type">substituteHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm%27"><span class="hs-identifier hs-type">NormalTerm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246793"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span></span><span>
</span><span id="line-349"></span><span id="substituteHead"><span class="annot"><span class="annottext">substituteHead :: forall head. NormalTerm -&gt; NormalTerm' head -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#substituteHead"><span class="hs-identifier hs-var hs-var">substituteHead</span></a></span></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247296"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247296"><span class="hs-identifier hs-var">innerBinder</span></a></span></span><span> </span><span id="local-6989586621679247297"><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247297"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247298"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247298"><span class="hs-identifier hs-var">arguments</span></a></span></span><span> </span><span id="local-6989586621679247299"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247299"><span class="hs-identifier hs-var">returnType</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247300"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247300"><span class="hs-identifier hs-var">outerBinder</span></a></span></span><span> </span><span class="annot"><span class="annottext">head
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Atom -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm
forall head.
[(Variable, Type)]
-&gt; head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#Term"><span class="hs-identifier hs-var">Term</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247300"><span class="hs-identifier hs-var">outerBinder</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; [(Variable, Type)] -&gt; [(Variable, Type)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247296"><span class="hs-identifier hs-var">innerBinder</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247297"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247298"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247299"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-353"></span><span class="annot"><a href="Language.Lambda.Typed.html#substituteHead"><span class="hs-identifier hs-var">substituteHead</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679247301"><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247301"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247302"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247302"><span class="hs-identifier hs-var">innerArguments</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247303"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247303"><span class="hs-identifier hs-var">outerBinder</span></a></span></span><span> </span><span class="annot"><span class="annottext">head
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247304"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247304"><span class="hs-identifier hs-var">outerArguments</span></a></span></span><span> </span><span id="local-6989586621679247305"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247305"><span class="hs-identifier hs-var">returnType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Atom -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm
forall head.
[(Variable, Type)]
-&gt; head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#Term"><span class="hs-identifier hs-var">Term</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247303"><span class="hs-identifier hs-var">outerBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247301"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247302"><span class="hs-identifier hs-var">innerArguments</span></a></span><span> </span><span class="annot"><span class="annottext">[NormalTerm] -&gt; [NormalTerm] -&gt; [NormalTerm]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247304"><span class="hs-identifier hs-var">outerArguments</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247305"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Language.Lambda.Typed.html#substituteHead"><span class="hs-identifier hs-var">substituteHead</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679247306"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247306"><span class="hs-identifier hs-var">parameter</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247307"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247307"><span class="hs-identifier hs-var">innerBinder</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247308"><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247308"><span class="hs-identifier hs-var">innerHead</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247309"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247309"><span class="hs-identifier hs-var">innerArguments</span></a></span></span><span> </span><span id="local-6989586621679247310"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247310"><span class="hs-identifier hs-var">innerReturnType</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247311"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247311"><span class="hs-identifier hs-var">outerBinder</span></a></span></span><span> </span><span id="local-6989586621679247312"><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679247312"><span class="hs-identifier hs-var">outerHead</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247313"><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247313"><span class="hs-identifier hs-var">argument</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247314"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247314"><span class="hs-identifier hs-var">outerArguments</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247315"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247315"><span class="hs-identifier hs-var">outerReturnType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><span class="annottext">NormalTerm -&gt; NormalTerm' head -&gt; NormalTerm
forall head. NormalTerm -&gt; NormalTerm' head -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#substituteHead"><span class="hs-identifier hs-var">substituteHead</span></a></span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Atom -&gt; NormalTerm -&gt; NormalTerm -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Variable -&gt; Atom
</span><a href="Language.Lambda.Typed.html#AVar"><span class="hs-identifier hs-var">AVar</span></a></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247306"><span class="hs-identifier hs-var">parameter</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247313"><span class="hs-identifier hs-var">argument</span></a></span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247317"><span class="hs-identifier hs-var">withoutParameter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Variable, Type)]
-&gt; head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
forall head.
[(Variable, Type)]
-&gt; head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#Term"><span class="hs-identifier hs-var">Term</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247311"><span class="hs-identifier hs-var">outerBinder</span></a></span><span> </span><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679247312"><span class="hs-identifier hs-var">outerHead</span></a></span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247314"><span class="hs-identifier hs-var">outerArguments</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247315"><span class="hs-identifier hs-var">outerReturnType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-364"></span><span>    </span><span id="local-6989586621679247317"><span class="annot"><span class="annottext">withoutParameter :: NormalTerm
</span><a href="#local-6989586621679247317"><span class="hs-identifier hs-var hs-var">withoutParameter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Atom -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm
forall head.
[(Variable, Type)]
-&gt; head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#Term"><span class="hs-identifier hs-var">Term</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247307"><span class="hs-identifier hs-var">innerBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247308"><span class="hs-identifier hs-var">innerHead</span></a></span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247309"><span class="hs-identifier hs-var">innerArguments</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247310"><span class="hs-identifier hs-var">innerReturnType</span></a></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- &gt;&gt;&gt; t = Base &quot;t&quot;</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- &gt;&gt;&gt; _M = AMetavar (Metavariable &quot;M&quot;)</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- &gt;&gt;&gt; a = AVar (Variable &quot;a&quot;)</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- &gt;&gt;&gt; (x, x') = (AVar x', Variable &quot;x&quot;)</span><span>
</span><span id="line-370"></span><span class="hs-comment">--</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- &gt;&gt;&gt; substitute _M (var a (Function t (Function t t))) (apply _M [var x t, var x t] t)</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- a (x :: t) (x :: t) :: t</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- &gt;&gt;&gt; substitute _M (var a t) (apply x [var _M t, var _M t] t)</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- x (a :: t) (a :: t) :: t</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- &gt;&gt;&gt; substitute _M (Term [(x', t)] x [] t) (apply _M [var a t] t)</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- a :: t</span><span>
</span><span id="line-377"></span><span class="annot"><a href="Language.Lambda.Typed.html#substitute"><span class="hs-identifier hs-type">substitute</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span>
</span><span id="line-378"></span><span id="substitute"><span class="annot"><span class="annottext">substitute :: Atom -&gt; NormalTerm -&gt; NormalTerm -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#substitute"><span class="hs-identifier hs-var hs-var">substitute</span></a></span></span><span>
</span><span id="line-379"></span><span>  </span><span id="local-6989586621679247318"><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247318"><span class="hs-identifier hs-var">expected</span></a></span></span><span>
</span><span id="line-380"></span><span>  </span><span id="local-6989586621679247319"><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247319"><span class="hs-identifier hs-var">substitution</span></a></span></span><span>
</span><span id="line-381"></span><span>  </span><span id="local-6989586621679247320"><span class="annot"><span class="annottext">outer :: NormalTerm
</span><a href="#local-6989586621679247320"><span class="hs-identifier hs-var">outer</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Heading"><span class="hs-identifier hs-type">Heading</span></a></span><span> </span><span id="local-6989586621679247321"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247321"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span id="local-6989586621679247322"><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247322"><span class="hs-identifier hs-var">head</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247323"><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247323"><span class="hs-identifier hs-var">arguments</span></a></span></span><span> </span><span id="local-6989586621679247324"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247324"><span class="hs-identifier hs-var">returnType</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247322"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">Atom -&gt; Atom -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247318"><span class="hs-identifier hs-var">expected</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-383"></span><span>        </span><span class="annot"><span class="annottext">Atom -&gt; NormalTerm -&gt; NormalTerm -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247318"><span class="hs-identifier hs-var">expected</span></a></span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247319"><span class="hs-identifier hs-var">substitution</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalTerm -&gt; NormalTerm -&gt; NormalTerm
forall head. NormalTerm -&gt; NormalTerm' head -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#substituteHead"><span class="hs-identifier hs-var">substituteHead</span></a></span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247319"><span class="hs-identifier hs-var">substitution</span></a></span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247320"><span class="hs-identifier hs-var">outer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>        </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Atom -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm
forall head.
[(Variable, Type)]
-&gt; head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#Term"><span class="hs-identifier hs-var">Term</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247321"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247322"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Atom -&gt; NormalTerm -&gt; NormalTerm -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247318"><span class="hs-identifier hs-var">expected</span></a></span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247319"><span class="hs-identifier hs-var">substitution</span></a></span><span> </span><span class="annot"><span class="annottext">(NormalTerm -&gt; NormalTerm) -&gt; [NormalTerm] -&gt; [NormalTerm]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247323"><span class="hs-identifier hs-var">arguments</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247324"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-keyword">newtype</span><span> </span><span id="DisagreementSet"><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-var">DisagreementSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DisagreementSet"><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-var">DisagreementSet</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247327"><span id="local-6989586621679247332"><span class="annot"><span class="annottext">DisagreementSet -&gt; DisagreementSet -&gt; Bool
(DisagreementSet -&gt; DisagreementSet -&gt; Bool)
-&gt; (DisagreementSet -&gt; DisagreementSet -&gt; Bool)
-&gt; Eq DisagreementSet
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: DisagreementSet -&gt; DisagreementSet -&gt; Bool
== :: DisagreementSet -&gt; DisagreementSet -&gt; Bool
$c/= :: DisagreementSet -&gt; DisagreementSet -&gt; Bool
/= :: DisagreementSet -&gt; DisagreementSet -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="annot"><a href="Language.Lambda.Typed.html#addToSet"><span class="hs-identifier hs-type">addToSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span>
</span><span id="line-391"></span><span id="addToSet"><span class="annot"><span class="annottext">addToSet :: NormalTerm -&gt; NormalTerm -&gt; DisagreementSet -&gt; DisagreementSet
</span><a href="Language.Lambda.Typed.html#addToSet"><span class="hs-identifier hs-var hs-var">addToSet</span></a></span></span><span> </span><span id="local-6989586621679247342"><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247342"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679247343"><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247343"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span> </span><span id="local-6989586621679247344"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247344"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; DisagreementSet
</span><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-var">DisagreementSet</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247342"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247343"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NormalTerm, NormalTerm)
-&gt; [(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247344"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="annot"><a href="Language.Lambda.Typed.html#substituteInSet"><span class="hs-identifier hs-type">substituteInSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span>
</span><span id="line-394"></span><span id="substituteInSet"><span class="annot"><span class="annottext">substituteInSet :: Atom -&gt; NormalTerm -&gt; DisagreementSet -&gt; DisagreementSet
</span><a href="Language.Lambda.Typed.html#substituteInSet"><span class="hs-identifier hs-var hs-var">substituteInSet</span></a></span></span><span> </span><span id="local-6989586621679247346"><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247346"><span class="hs-identifier hs-var">head</span></a></span></span><span> </span><span id="local-6989586621679247347"><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247347"><span class="hs-identifier hs-var">substitution</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span> </span><span id="local-6989586621679247348"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247348"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; DisagreementSet
</span><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-var">DisagreementSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NormalTerm -&gt; NormalTerm)
-&gt; (NormalTerm -&gt; NormalTerm)
-&gt; (NormalTerm, NormalTerm)
-&gt; (NormalTerm, NormalTerm)
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; (a, c) -&gt; (b, d)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">NormalTerm -&gt; NormalTerm
</span><a href="#local-6989586621679247349"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">NormalTerm -&gt; NormalTerm
</span><a href="#local-6989586621679247349"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">((NormalTerm, NormalTerm) -&gt; (NormalTerm, NormalTerm))
-&gt; [(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247348"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>  </span><span id="local-6989586621679247349"><span class="annot"><span class="annottext">go :: NormalTerm -&gt; NormalTerm
</span><a href="#local-6989586621679247349"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Atom -&gt; NormalTerm -&gt; NormalTerm -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#substitute"><span class="hs-identifier hs-var">substitute</span></a></span><span> </span><span class="annot"><span class="annottext">Atom
</span><a href="#local-6989586621679247346"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247347"><span class="hs-identifier hs-var">substitution</span></a></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679247351"><span id="local-6989586621679247356"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>  </span><span id="local-6989586621679247360"><span class="annot"><span class="annottext">show :: DisagreementSet -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{}&quot;</span></span><span>
</span><span id="line-401"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span> </span><span id="local-6989586621679247361"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247361"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{ &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247362"><span class="hs-identifier hs-var">set'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; }&quot;</span></span><span>
</span><span id="line-402"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-403"></span><span>    </span><span id="local-6989586621679247362"><span class="annot"><span class="annottext">set' :: String
</span><a href="#local-6989586621679247362"><span class="hs-identifier hs-var hs-var">set'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;; &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NormalTerm, NormalTerm) -&gt; String
forall {a} {a}. (Show a, Show a) =&gt; (a, a) -&gt; String
</span><a href="#local-6989586621679247367"><span class="hs-identifier hs-var">showPair</span></a></span><span> </span><span class="annot"><span class="annottext">((NormalTerm, NormalTerm) -&gt; String)
-&gt; [(NormalTerm, NormalTerm)] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247361"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>    </span><span id="local-6989586621679247367"><span class="annot"><span class="annottext">showPair :: (a, a) -&gt; String
</span><a href="#local-6989586621679247367"><span class="hs-identifier hs-var hs-var">showPair</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247374"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247374"><span class="hs-identifier hs-var">left</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247375"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247375"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247374"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247375"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-keyword">newtype</span><span> </span><span id="Substitutions"><span class="annot"><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-var">Substitutions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Substitutions"><span class="annot"><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-var">Substitutions</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247378"><span id="local-6989586621679247383"><span class="annot"><span class="annottext">Substitutions -&gt; Substitutions -&gt; Bool
(Substitutions -&gt; Substitutions -&gt; Bool)
-&gt; (Substitutions -&gt; Substitutions -&gt; Bool) -&gt; Eq Substitutions
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Substitutions -&gt; Substitutions -&gt; Bool
== :: Substitutions -&gt; Substitutions -&gt; Bool
$c/= :: Substitutions -&gt; Substitutions -&gt; Bool
/= :: Substitutions -&gt; Substitutions -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679247393"><span id="local-6989586621679247398"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-type">Substitutions</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>  </span><span id="local-6989586621679247402"><span class="annot"><span class="annottext">show :: Substitutions -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-type">Substitutions</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{}&quot;</span></span><span>
</span><span id="line-411"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-type">Substitutions</span></a></span><span> </span><span id="local-6989586621679247403"><span class="annot"><span class="annottext">[(Metavariable, NormalTerm)]
</span><a href="#local-6989586621679247403"><span class="hs-identifier hs-var">substitutions</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;{ &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679247404"><span class="hs-identifier hs-var">substitutions'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; }&quot;</span></span><span>
</span><span id="line-412"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-413"></span><span>    </span><span id="local-6989586621679247404"><span class="annot"><span class="annottext">substitutions' :: String
</span><a href="#local-6989586621679247404"><span class="hs-identifier hs-var hs-var">substitutions'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;; &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Metavariable, NormalTerm) -&gt; String
forall {a} {a}. (Show a, Show a) =&gt; (a, a) -&gt; String
</span><a href="#local-6989586621679247409"><span class="hs-identifier hs-var">showSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">((Metavariable, NormalTerm) -&gt; String)
-&gt; [(Metavariable, NormalTerm)] -&gt; [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Metavariable, NormalTerm)]
</span><a href="#local-6989586621679247403"><span class="hs-identifier hs-var">substitutions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>    </span><span id="local-6989586621679247409"><span class="annot"><span class="annottext">showSubstitution :: (a, a) -&gt; String
</span><a href="#local-6989586621679247409"><span class="hs-identifier hs-var hs-var">showSubstitution</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247416"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247416"><span class="hs-identifier hs-var">left</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247417"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247417"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247416"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; =&gt; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247417"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span class="annot"><a href="Language.Lambda.Typed.html#addSubstitution"><span class="hs-identifier hs-type">addSubstitution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-type">Substitutions</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-type">Substitutions</span></a></span><span>
</span><span id="line-417"></span><span id="addSubstitution"><span class="annot"><span class="annottext">addSubstitution :: Metavariable -&gt; NormalTerm -&gt; Substitutions -&gt; Substitutions
</span><a href="Language.Lambda.Typed.html#addSubstitution"><span class="hs-identifier hs-var hs-var">addSubstitution</span></a></span></span><span> </span><span id="local-6989586621679247419"><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247419"><span class="hs-identifier hs-var">head</span></a></span></span><span> </span><span id="local-6989586621679247420"><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247420"><span class="hs-identifier hs-var">substitution</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-type">Substitutions</span></a></span><span> </span><span id="local-6989586621679247421"><span class="annot"><span class="annottext">[(Metavariable, NormalTerm)]
</span><a href="#local-6989586621679247421"><span class="hs-identifier hs-var">substitutions</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-418"></span><span>  </span><span class="annot"><span class="annottext">[(Metavariable, NormalTerm)] -&gt; Substitutions
</span><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-var">Substitutions</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247419"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247420"><span class="hs-identifier hs-var">substitution</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Metavariable, NormalTerm)
-&gt; [(Metavariable, NormalTerm)] -&gt; [(Metavariable, NormalTerm)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Metavariable, NormalTerm)]
</span><a href="#local-6989586621679247421"><span class="hs-identifier hs-var">substitutions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">-- &gt;&gt;&gt; _F = AMetavar (Metavariable &quot;F&quot;)</span><span>
</span><span id="line-421"></span><span class="hs-comment">-- &gt;&gt;&gt; _X = AMetavar (Metavariable &quot;X&quot;)</span><span>
</span><span id="line-422"></span><span class="hs-comment">-- &gt;&gt;&gt; _W = AMetavar (Metavariable &quot;W&quot;)</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- &gt;&gt;&gt; (a', a) = (Variable &quot;a&quot;, AVar a')</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- &gt;&gt;&gt; (b', b) = (Variable &quot;b&quot;, AVar b')</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- &gt;&gt;&gt; (c', c) = (Variable &quot;c&quot;, AVar c')</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- &gt;&gt;&gt; (d', d) = (Variable &quot;d&quot;, AVar d')</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- &gt;&gt;&gt; (e', e) = (Variable &quot;e&quot;, AVar e')</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- &gt;&gt;&gt; (f', f) = (Variable &quot;f&quot;, AVar f')</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- &gt;&gt;&gt; (u', u) = (Variable &quot;u&quot;, AVar u')</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- &gt;&gt;&gt; (v', v) = (Variable &quot;v&quot;, AVar v')</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- &gt;&gt;&gt; t = Base &quot;t&quot;</span><span>
</span><span id="line-432"></span><span class="hs-comment">--</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- &gt;&gt;&gt; left = apply _F [apply _F [var _X t] t] t</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- &gt;&gt;&gt; right = apply a [apply a [var b t] t] t</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- &gt;&gt;&gt; solve (DisagreementSet [(left, right)]) someVariables someMetavariables</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- [({ X =&gt; b :: t; F =&gt; a :: t -&gt; t },{}),({ M1 =&gt; &#955;v2: t. b :: t; M0 =&gt; &#955;v1: t. a (M1 (v1 :: t) :: t) :: t; F =&gt; &#955;v0: t. a (M0 (v0 :: t) :: t) :: t },{}),({ X =&gt; b :: t; M0 =&gt; &#955;v1: t. v1 :: t; F =&gt; &#955;v0: t. a (M0 (v0 :: t) :: t) :: t },{}),({ M1 =&gt; b :: t; M0 =&gt; a (M1 :: t) :: t; X =&gt; a (M0 :: t) :: t; F =&gt; &#955;v0: t. v0 :: t },{})]</span><span>
</span><span id="line-437"></span><span class="hs-comment">--</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- &gt;&gt;&gt; tc = Function (Function t t) (Function t (Function t t))</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- &gt;&gt;&gt; left = var _X (Function tc t)</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- &gt;&gt;&gt; ex = Term [(d', Function t t), (e', t), (f', t)] a [apply d [var e t] t, var f t] t</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- &gt;&gt;&gt; right = Term [(u', tc)] u [Term [(v', t)] _W [] t, apply _X [ex] t, apply _X [var _F tc] t] t</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- &gt;&gt;&gt; solve (DisagreementSet [(left, right)]) someVariables someMetavariables</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- [({ M1 =&gt; &#955;v1: (t -&gt; t) -&gt; t -&gt; t -&gt; t. a (M3 (v1 :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t) (M4 (v1 :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t) :: t; X =&gt; &#955;v0: (t -&gt; t) -&gt; t -&gt; t -&gt; t. v0 (M0 (v0 :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t -&gt; t) (M1 (v0 :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t) (M2 (v0 :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t) :: t },{ &#955;v0: (t -&gt; t) -&gt; t -&gt; t -&gt; t. M3 (v0 :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t = &#955;u: (t -&gt; t) -&gt; t -&gt; t -&gt; t. M0 (&#955;d: t -&gt; t, e: t, f: t. a (d (e :: t) :: t) (f :: t) :: t) (a (M3 (&#955;d: t -&gt; t, e: t, f: t. a (d (e :: t) :: t) (f :: t) :: t) :: t) (M4 (&#955;d: t -&gt; t, e: t, f: t. a (d (e :: t) :: t) (f :: t) :: t) :: t) :: t) :: t; &#955;v0: (t -&gt; t) -&gt; t -&gt; t -&gt; t. M4 (v0 :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t = &#955;u: (t -&gt; t) -&gt; t -&gt; t -&gt; t. M2 (&#955;d: t -&gt; t, e: t, f: t. a (d (e :: t) :: t) (f :: t) :: t) :: t; &#955;v0: (t -&gt; t) -&gt; t -&gt; t -&gt; t. M0 (v0 :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t -&gt; t = &#955;u: (t -&gt; t) -&gt; t -&gt; t -&gt; t, v: t. W :: t; &#955;v0: (t -&gt; t) -&gt; t -&gt; t -&gt; t. M2 (v0 :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t = &#955;u: (t -&gt; t) -&gt; t -&gt; t -&gt; t. F (M0 (F :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t -&gt; t) (a (M3 (F :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t) (M4 (F :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t) :: t) (M2 (F :: (t -&gt; t) -&gt; t -&gt; t -&gt; t) :: t) :: t })]</span><span>
</span><span id="line-444"></span><span class="hs-comment">--</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- &gt;&gt;&gt; left = apply a [var _X t, apply _F [var b (Function t t)] t] t</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- &gt;&gt;&gt; right = apply a [apply _F [Term [(u', t)] _X [] t] t, apply b [var _X t] t] t</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- &gt;&gt;&gt; take 1 $ solve (DisagreementSet [(left, right)]) someVariables someMetavariables</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- [({ F =&gt; &#955;v0: t -&gt; t. v0 (M0 (v0 :: t -&gt; t) :: t) :: t },{ M0 (b :: t -&gt; t) :: t = X :: t; X :: t = X :: t })]</span><span>
</span><span id="line-449"></span><span class="annot"><a href="Language.Lambda.Typed.html#solve"><span class="hs-identifier hs-type">solve</span></a></span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-type">Substitutions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-454"></span><span id="solve"><span class="annot"><span class="annottext">solve :: DisagreementSet
-&gt; Stream Variable
-&gt; Stream Metavariable
-&gt; [(Substitutions, DisagreementSet)]
</span><a href="Language.Lambda.Typed.html#solve"><span class="hs-identifier hs-var hs-var">solve</span></a></span></span><span> </span><span id="local-6989586621679247422"><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247422"><span class="hs-identifier hs-var">initialSet</span></a></span></span><span> </span><span id="local-6989586621679247423"><span class="annot"><span class="annottext">Stream Variable
</span><a href="#local-6989586621679247423"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679247424"><span class="annot"><span class="annottext">Stream Metavariable
</span><a href="#local-6989586621679247424"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Context, DisagreementSet)] -&gt; [(Substitutions, DisagreementSet)]
</span><a href="#local-6989586621679247425"><span class="hs-identifier hs-var">go'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Substitutions -&gt; Stream Variable -&gt; Stream Metavariable -&gt; Context
</span><a href="Language.Lambda.Typed.html#Context"><span class="hs-identifier hs-var">Context</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Metavariable, NormalTerm)] -&gt; Substitutions
</span><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-var">Substitutions</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stream Variable
</span><a href="#local-6989586621679247423"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Stream Metavariable
</span><a href="#local-6989586621679247424"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247422"><span class="hs-identifier hs-var">initialSet</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-455"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-456"></span><span>  </span><span id="local-6989586621679247425"><span class="annot"><span class="annottext">go' :: [(Context, DisagreementSet)] -&gt; [(Substitutions, DisagreementSet)]
</span><a href="#local-6989586621679247425"><span class="hs-identifier hs-var hs-var">go'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-457"></span><span>  </span><span class="annot"><a href="#local-6989586621679247425"><span class="hs-identifier hs-var">go'</span></a></span><span> </span><span id="local-6989586621679247429"><span class="annot"><span class="annottext">[(Context, DisagreementSet)]
</span><a href="#local-6989586621679247429"><span class="hs-identifier hs-var">sets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Context, DisagreementSet) -&gt; (Substitutions, DisagreementSet)
forall {b}. (Context, b) -&gt; (Substitutions, b)
</span><a href="#local-6989586621679247430"><span class="hs-identifier hs-var">extractSubstitutions</span></a></span><span> </span><span class="annot"><span class="annottext">((Context, DisagreementSet) -&gt; (Substitutions, DisagreementSet))
-&gt; [(Context, DisagreementSet)]
-&gt; [(Substitutions, DisagreementSet)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Context, DisagreementSet)]
</span><a href="#local-6989586621679247431"><span class="hs-identifier hs-var">solved</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Substitutions, DisagreementSet)]
-&gt; [(Substitutions, DisagreementSet)]
-&gt; [(Substitutions, DisagreementSet)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Context, DisagreementSet)] -&gt; [(Substitutions, DisagreementSet)]
</span><a href="#local-6989586621679247425"><span class="hs-identifier hs-var">go'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Context, (FlexibleTerm, RigidTerm, DisagreementSet))]
-&gt; [(Context, DisagreementSet)]
</span><a href="#local-6989586621679247432"><span class="hs-identifier hs-var">goSolve</span></a></span><span> </span><span class="annot"><span class="annottext">[(Context, (FlexibleTerm, RigidTerm, DisagreementSet))]
</span><a href="#local-6989586621679247433"><span class="hs-identifier hs-var">unsolved</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679247431"><span class="annot"><span class="annottext">[(Context, DisagreementSet)]
</span><a href="#local-6989586621679247431"><span class="hs-identifier hs-var">solved</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247433"><span class="annot"><span class="annottext">[(Context, (FlexibleTerm, RigidTerm, DisagreementSet))]
</span><a href="#local-6989586621679247433"><span class="hs-identifier hs-var">unsolved</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Context, DisagreementSet)]
-&gt; ([(Context, DisagreementSet)],
    [(Context, (FlexibleTerm, RigidTerm, DisagreementSet))])
forall c.
[(c, DisagreementSet)] -&gt; ([(c, DisagreementSet)], [Solvable c])
</span><a href="Language.Lambda.Typed.html#pickPairs"><span class="hs-identifier hs-var">pickPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Context, DisagreementSet)] -&gt; [(Context, DisagreementSet)]
forall c. [(c, DisagreementSet)] -&gt; [(c, DisagreementSet)]
</span><a href="Language.Lambda.Typed.html#simplifySets"><span class="hs-identifier hs-var">simplifySets</span></a></span><span> </span><span class="annot"><span class="annottext">[(Context, DisagreementSet)]
</span><a href="#local-6989586621679247429"><span class="hs-identifier hs-var">sets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>    </span><span id="local-6989586621679247430"><span class="annot"><span class="annottext">extractSubstitutions :: (Context, b) -&gt; (Substitutions, b)
</span><a href="#local-6989586621679247430"><span class="hs-identifier hs-var hs-var">extractSubstitutions</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span id="local-6989586621679247436"><span class="annot"><span class="annottext">Substitutions
</span><a href="#local-6989586621679247436"><span class="hs-identifier hs-var">substitutions</span></a></span></span><span> </span><span class="annot"><span class="annottext">Stream Variable
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Stream Metavariable
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247437"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679247437"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Substitutions
</span><a href="#local-6989586621679247436"><span class="hs-identifier hs-var">substitutions</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679247437"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>  </span><span id="local-6989586621679247432"><span class="annot"><span class="annottext">goSolve :: [(Context, (FlexibleTerm, RigidTerm, DisagreementSet))]
-&gt; [(Context, DisagreementSet)]
</span><a href="#local-6989586621679247432"><span class="hs-identifier hs-var hs-var">goSolve</span></a></span></span><span> </span><span id="local-6989586621679247442"><span class="annot"><span class="annottext">[(Context, (FlexibleTerm, RigidTerm, DisagreementSet))]
</span><a href="#local-6989586621679247442"><span class="hs-identifier hs-var">problems</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span> </span><span id="local-6989586621679247443"><span class="annot"><span class="annottext">Substitutions
</span><a href="#local-6989586621679247443"><span class="hs-identifier hs-var">substitutions</span></a></span></span><span> </span><span id="local-6989586621679247444"><span class="annot"><span class="annottext">Stream Variable
</span><a href="#local-6989586621679247444"><span class="hs-identifier hs-var">variables</span></a></span></span><span> </span><span id="local-6989586621679247445"><span class="annot"><span class="annottext">Stream Metavariable
</span><a href="#local-6989586621679247445"><span class="hs-identifier hs-var">metavariables</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247446"><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247446"><span class="hs-identifier hs-var">flexible</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247447"><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247447"><span class="hs-identifier hs-var">rigid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247448"><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247448"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Context, (FlexibleTerm, RigidTerm, DisagreementSet))]
</span><a href="#local-6989586621679247442"><span class="hs-identifier hs-var">problems</span></a></span><span>
</span><span id="line-463"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679247449"><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247449"><span class="hs-identifier hs-var">substitution</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247450"><span class="annot"><span class="annottext">Stream Variable
</span><a href="#local-6989586621679247450"><span class="hs-identifier hs-var">variables'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247451"><span class="annot"><span class="annottext">Stream Metavariable
</span><a href="#local-6989586621679247451"><span class="hs-identifier hs-var">metavariables'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FlexibleTerm
-&gt; RigidTerm
-&gt; Stream Variable
-&gt; Stream Metavariable
-&gt; [(NormalTerm, Stream Variable, Stream Metavariable)]
</span><a href="Language.Lambda.Typed.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247446"><span class="hs-identifier hs-var">flexible</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247447"><span class="hs-identifier hs-var">rigid</span></a></span><span> </span><span class="annot"><span class="annottext">Stream Variable
</span><a href="#local-6989586621679247444"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">Stream Metavariable
</span><a href="#local-6989586621679247445"><span class="hs-identifier hs-var">metavariables</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247453"><span class="annot"><span class="annottext">unknown :: Metavariable
</span><a href="#local-6989586621679247453"><span class="hs-identifier hs-var hs-var">unknown</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Heading Metavariable -&gt; Metavariable
forall head. Heading head -&gt; head
</span><a href="Language.Lambda.Typed.html#head"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexibleTerm -&gt; Heading Metavariable
forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247446"><span class="hs-identifier hs-var">flexible</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247454"><span class="annot"><span class="annottext">set' :: DisagreementSet
</span><a href="#local-6989586621679247454"><span class="hs-identifier hs-var hs-var">set'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NormalTerm -&gt; NormalTerm -&gt; DisagreementSet -&gt; DisagreementSet
</span><a href="Language.Lambda.Typed.html#addToSet"><span class="hs-identifier hs-var">addToSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexibleTerm -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#Flexible"><span class="hs-identifier hs-var">Flexible</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247446"><span class="hs-identifier hs-var">flexible</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; NormalTerm
</span><a href="Language.Lambda.Typed.html#Rigid"><span class="hs-identifier hs-var">Rigid</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247447"><span class="hs-identifier hs-var">rigid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247448"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-467"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247455"><span class="annot"><span class="annottext">set'' :: DisagreementSet
</span><a href="#local-6989586621679247455"><span class="hs-identifier hs-var hs-var">set''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Atom -&gt; NormalTerm -&gt; DisagreementSet -&gt; DisagreementSet
</span><a href="Language.Lambda.Typed.html#substituteInSet"><span class="hs-identifier hs-var">substituteInSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Metavariable -&gt; Atom
</span><a href="Language.Lambda.Typed.html#AMetavar"><span class="hs-identifier hs-var">AMetavar</span></a></span><span> </span><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247453"><span class="hs-identifier hs-var">unknown</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247449"><span class="hs-identifier hs-var">substitution</span></a></span><span> </span><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247454"><span class="hs-identifier hs-var">set'</span></a></span><span>
</span><span id="line-468"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247456"><span class="annot"><span class="annottext">substitutions' :: Substitutions
</span><a href="#local-6989586621679247456"><span class="hs-identifier hs-var hs-var">substitutions'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Metavariable -&gt; NormalTerm -&gt; Substitutions -&gt; Substitutions
</span><a href="Language.Lambda.Typed.html#addSubstitution"><span class="hs-identifier hs-var">addSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247453"><span class="hs-identifier hs-var">unknown</span></a></span><span> </span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247449"><span class="hs-identifier hs-var">substitution</span></a></span><span> </span><span class="annot"><span class="annottext">Substitutions
</span><a href="#local-6989586621679247443"><span class="hs-identifier hs-var">substitutions</span></a></span><span>
</span><span id="line-469"></span><span>    </span><span class="annot"><span class="annottext">(Context, DisagreementSet) -&gt; [(Context, DisagreementSet)]
forall a. a -&gt; [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Substitutions -&gt; Stream Variable -&gt; Stream Metavariable -&gt; Context
</span><a href="Language.Lambda.Typed.html#Context"><span class="hs-identifier hs-var">Context</span></a></span><span> </span><span class="annot"><span class="annottext">Substitutions
</span><a href="#local-6989586621679247456"><span class="hs-identifier hs-var">substitutions'</span></a></span><span> </span><span class="annot"><span class="annottext">Stream Variable
</span><a href="#local-6989586621679247450"><span class="hs-identifier hs-var">variables'</span></a></span><span> </span><span class="annot"><span class="annottext">Stream Metavariable
</span><a href="#local-6989586621679247451"><span class="hs-identifier hs-var">metavariables'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247455"><span class="hs-identifier hs-var">set''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="hs-keyword">data</span><span> </span><span id="Context"><span class="annot"><a href="Language.Lambda.Typed.html#Context"><span class="hs-identifier hs-var">Context</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Context"><span class="annot"><a href="Language.Lambda.Typed.html#Context"><span class="hs-identifier hs-var">Context</span></a></span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Substitutions"><span class="hs-identifier hs-type">Substitutions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span id="local-6989586621679246810"><span class="annot"><a href="Language.Lambda.Typed.html#simplifySets"><span class="hs-identifier hs-type">simplifySets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679246810"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679246810"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-474"></span><span id="simplifySets"><span class="annot"><span class="annottext">simplifySets :: forall c. [(c, DisagreementSet)] -&gt; [(c, DisagreementSet)]
</span><a href="Language.Lambda.Typed.html#simplifySets"><span class="hs-identifier hs-var hs-var">simplifySets</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-475"></span><span class="annot"><a href="Language.Lambda.Typed.html#simplifySets"><span class="hs-identifier hs-var">simplifySets</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679247457"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679247457"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247458"><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247458"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247459"><span class="annot"><span class="annottext">[(c, DisagreementSet)]
</span><a href="#local-6989586621679247459"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DisagreementSet -&gt; Maybe DisagreementSet
</span><a href="Language.Lambda.Typed.html#simplify"><span class="hs-identifier hs-var">simplify</span></a></span><span> </span><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247458"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-476"></span><span>  </span><span class="annot"><span class="annottext">Maybe DisagreementSet
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(c, DisagreementSet)] -&gt; [(c, DisagreementSet)]
forall c. [(c, DisagreementSet)] -&gt; [(c, DisagreementSet)]
</span><a href="Language.Lambda.Typed.html#simplifySets"><span class="hs-identifier hs-var">simplifySets</span></a></span><span> </span><span class="annot"><span class="annottext">[(c, DisagreementSet)]
</span><a href="#local-6989586621679247459"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679247461"><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247461"><span class="hs-identifier hs-var">set'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679247457"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247461"><span class="hs-identifier hs-var">set'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(c, DisagreementSet)
-&gt; [(c, DisagreementSet)] -&gt; [(c, DisagreementSet)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(c, DisagreementSet)] -&gt; [(c, DisagreementSet)]
forall c. [(c, DisagreementSet)] -&gt; [(c, DisagreementSet)]
</span><a href="Language.Lambda.Typed.html#simplifySets"><span class="hs-identifier hs-var">simplifySets</span></a></span><span> </span><span class="annot"><span class="annottext">[(c, DisagreementSet)]
</span><a href="#local-6989586621679247459"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-keyword">type</span><span> </span><span id="Solved"><span class="annot"><a href="Language.Lambda.Typed.html#Solved"><span class="hs-identifier hs-var">Solved</span></a></span></span><span> </span><span id="local-6989586621679247463"><span class="annot"><a href="#local-6989586621679247463"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679247463"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span class="hs-keyword">type</span><span> </span><span id="Solvable"><span class="annot"><a href="Language.Lambda.Typed.html#Solvable"><span class="hs-identifier hs-var">Solvable</span></a></span></span><span> </span><span id="local-6989586621679247464"><span class="annot"><a href="#local-6989586621679247464"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679247464"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#FlexibleTerm"><span class="hs-identifier hs-type">FlexibleTerm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#RigidTerm"><span class="hs-identifier hs-type">RigidTerm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span id="local-6989586621679246808"><span class="annot"><a href="Language.Lambda.Typed.html#pickPairs"><span class="hs-identifier hs-type">pickPairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679246808"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Lambda.Typed.html#Solved"><span class="hs-identifier hs-type">Solved</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246808"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Lambda.Typed.html#Solvable"><span class="hs-identifier hs-type">Solvable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246808"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-482"></span><span id="pickPairs"><span class="annot"><span class="annottext">pickPairs :: forall c.
[(c, DisagreementSet)] -&gt; ([(c, DisagreementSet)], [Solvable c])
</span><a href="Language.Lambda.Typed.html#pickPairs"><span class="hs-identifier hs-var hs-var">pickPairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(c, DisagreementSet)] -&gt; [(c, DisagreementSet)])
-&gt; ([(c, (FlexibleTerm, RigidTerm, DisagreementSet))]
    -&gt; [(c, (FlexibleTerm, RigidTerm, DisagreementSet))])
-&gt; [(c, DisagreementSet)]
-&gt; ([(c, DisagreementSet)],
    [(c, (FlexibleTerm, RigidTerm, DisagreementSet))])
forall {a} {c} {b}.
([(a, DisagreementSet)] -&gt; c)
-&gt; ([(a, (FlexibleTerm, RigidTerm, DisagreementSet))] -&gt; b)
-&gt; [(a, DisagreementSet)]
-&gt; (c, b)
</span><a href="#local-6989586621679247465"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(c, DisagreementSet)] -&gt; [(c, DisagreementSet)]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[(c, (FlexibleTerm, RigidTerm, DisagreementSet))]
-&gt; [(c, (FlexibleTerm, RigidTerm, DisagreementSet))]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-483"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-484"></span><span>  </span><span id="local-6989586621679247465"><span class="annot"><span class="annottext">go :: ([(a, DisagreementSet)] -&gt; c)
-&gt; ([(a, (FlexibleTerm, RigidTerm, DisagreementSet))] -&gt; b)
-&gt; [(a, DisagreementSet)]
-&gt; (c, b)
</span><a href="#local-6989586621679247465"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679247467"><span class="annot"><span class="annottext">[(a, DisagreementSet)] -&gt; c
</span><a href="#local-6989586621679247467"><span class="hs-identifier hs-var">solved</span></a></span></span><span> </span><span id="local-6989586621679247468"><span class="annot"><span class="annottext">[(a, (FlexibleTerm, RigidTerm, DisagreementSet))] -&gt; b
</span><a href="#local-6989586621679247468"><span class="hs-identifier hs-var">unsolved</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, DisagreementSet)] -&gt; c
</span><a href="#local-6989586621679247467"><span class="hs-identifier hs-var">solved</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(a, (FlexibleTerm, RigidTerm, DisagreementSet))] -&gt; b
</span><a href="#local-6989586621679247468"><span class="hs-identifier hs-var">unsolved</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>  </span><span class="annot"><a href="#local-6989586621679247465"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679247469"><span class="annot"><span class="annottext">[(a, DisagreementSet)] -&gt; c
</span><a href="#local-6989586621679247469"><span class="hs-identifier hs-var">solved</span></a></span></span><span> </span><span id="local-6989586621679247470"><span class="annot"><span class="annottext">[(a, (FlexibleTerm, RigidTerm, DisagreementSet))] -&gt; b
</span><a href="#local-6989586621679247470"><span class="hs-identifier hs-var">unsolved</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679247471"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247471"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247472"><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247472"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247473"><span class="annot"><span class="annottext">[(a, DisagreementSet)]
</span><a href="#local-6989586621679247473"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DisagreementSet -&gt; Maybe (FlexibleTerm, RigidTerm, DisagreementSet)
</span><a href="Language.Lambda.Typed.html#pickPair"><span class="hs-identifier hs-var">pickPair</span></a></span><span> </span><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247472"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-486"></span><span>    </span><span class="annot"><span class="annottext">Maybe (FlexibleTerm, RigidTerm, DisagreementSet)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(a, DisagreementSet)] -&gt; c)
-&gt; ([(a, (FlexibleTerm, RigidTerm, DisagreementSet))] -&gt; b)
-&gt; [(a, DisagreementSet)]
-&gt; (c, b)
</span><a href="#local-6989586621679247465"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, DisagreementSet)] -&gt; c
</span><a href="#local-6989586621679247469"><span class="hs-identifier hs-var">solved</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, DisagreementSet)] -&gt; c)
-&gt; ([(a, DisagreementSet)] -&gt; [(a, DisagreementSet)])
-&gt; [(a, DisagreementSet)]
-&gt; c
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247471"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DisagreementSet
</span><a href="#local-6989586621679247472"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, DisagreementSet)
-&gt; [(a, DisagreementSet)] -&gt; [(a, DisagreementSet)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, (FlexibleTerm, RigidTerm, DisagreementSet))] -&gt; b
</span><a href="#local-6989586621679247470"><span class="hs-identifier hs-var">unsolved</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, DisagreementSet)]
</span><a href="#local-6989586621679247473"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679247476"><span class="annot"><span class="annottext">(FlexibleTerm, RigidTerm, DisagreementSet)
</span><a href="#local-6989586621679247476"><span class="hs-identifier hs-var">problem</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(a, DisagreementSet)] -&gt; c)
-&gt; ([(a, (FlexibleTerm, RigidTerm, DisagreementSet))] -&gt; b)
-&gt; [(a, DisagreementSet)]
-&gt; (c, b)
</span><a href="#local-6989586621679247465"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, DisagreementSet)] -&gt; c
</span><a href="#local-6989586621679247469"><span class="hs-identifier hs-var">solved</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, (FlexibleTerm, RigidTerm, DisagreementSet))] -&gt; b
</span><a href="#local-6989586621679247470"><span class="hs-identifier hs-var">unsolved</span></a></span><span> </span><span class="annot"><span class="annottext">([(a, (FlexibleTerm, RigidTerm, DisagreementSet))] -&gt; b)
-&gt; ([(a, (FlexibleTerm, RigidTerm, DisagreementSet))]
    -&gt; [(a, (FlexibleTerm, RigidTerm, DisagreementSet))])
-&gt; [(a, (FlexibleTerm, RigidTerm, DisagreementSet))]
-&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247471"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(FlexibleTerm, RigidTerm, DisagreementSet)
</span><a href="#local-6989586621679247476"><span class="hs-identifier hs-var">problem</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, (FlexibleTerm, RigidTerm, DisagreementSet))
-&gt; [(a, (FlexibleTerm, RigidTerm, DisagreementSet))]
-&gt; [(a, (FlexibleTerm, RigidTerm, DisagreementSet))]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, DisagreementSet)]
</span><a href="#local-6989586621679247473"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span class="annot"><a href="Language.Lambda.Typed.html#pickPair"><span class="hs-identifier hs-type">pickPair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#FlexibleTerm"><span class="hs-identifier hs-type">FlexibleTerm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#RigidTerm"><span class="hs-identifier hs-type">RigidTerm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span id="pickPair"><span class="annot"><span class="annottext">pickPair :: DisagreementSet -&gt; Maybe (FlexibleTerm, RigidTerm, DisagreementSet)
</span><a href="Language.Lambda.Typed.html#pickPair"><span class="hs-identifier hs-var hs-var">pickPair</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span> </span><span id="local-6989586621679247477"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247477"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)])
-&gt; [(NormalTerm, NormalTerm)]
-&gt; Maybe (FlexibleTerm, RigidTerm, DisagreementSet)
</span><a href="#local-6989586621679247478"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247477"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-491"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-492"></span><span>  </span><span id="local-6989586621679247478"><span class="annot"><span class="annottext">go :: ([(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)])
-&gt; [(NormalTerm, NormalTerm)]
-&gt; Maybe (FlexibleTerm, RigidTerm, DisagreementSet)
</span><a href="#local-6989586621679247478"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (FlexibleTerm, RigidTerm, DisagreementSet)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-493"></span><span>  </span><span class="annot"><a href="#local-6989586621679247478"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679247479"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247479"><span class="hs-identifier hs-var">previous</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span id="local-6989586621679247480"><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247480"><span class="hs-identifier hs-var">flexible</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Rigid"><span class="hs-identifier hs-type">Rigid</span></a></span><span> </span><span id="local-6989586621679247481"><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247481"><span class="hs-identifier hs-var">rigid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247482"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247482"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><span class="annottext">(FlexibleTerm, RigidTerm, DisagreementSet)
-&gt; Maybe (FlexibleTerm, RigidTerm, DisagreementSet)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247480"><span class="hs-identifier hs-var">flexible</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247481"><span class="hs-identifier hs-var">rigid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; DisagreementSet
</span><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-var">DisagreementSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247479"><span class="hs-identifier hs-var">previous</span></a></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247482"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>  </span><span class="annot"><a href="#local-6989586621679247478"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679247483"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247483"><span class="hs-identifier hs-var">previous</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Rigid"><span class="hs-identifier hs-type">Rigid</span></a></span><span> </span><span id="local-6989586621679247484"><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247484"><span class="hs-identifier hs-var">rigid</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Flexible"><span class="hs-identifier hs-type">Flexible</span></a></span><span> </span><span id="local-6989586621679247485"><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247485"><span class="hs-identifier hs-var">flexible</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247486"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247486"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><span class="annottext">(FlexibleTerm, RigidTerm, DisagreementSet)
-&gt; Maybe (FlexibleTerm, RigidTerm, DisagreementSet)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247485"><span class="hs-identifier hs-var">flexible</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247484"><span class="hs-identifier hs-var">rigid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; DisagreementSet
</span><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-var">DisagreementSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247483"><span class="hs-identifier hs-var">previous</span></a></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247486"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>  </span><span class="annot"><a href="#local-6989586621679247478"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679247487"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247487"><span class="hs-identifier hs-var">previous</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247488"><span class="annot"><span class="annottext">(NormalTerm, NormalTerm)
</span><a href="#local-6989586621679247488"><span class="hs-identifier hs-var">pair</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247489"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247489"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)])
-&gt; [(NormalTerm, NormalTerm)]
-&gt; Maybe (FlexibleTerm, RigidTerm, DisagreementSet)
</span><a href="#local-6989586621679247478"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247487"><span class="hs-identifier hs-var">previous</span></a></span><span> </span><span class="annot"><span class="annottext">([(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)])
-&gt; ([(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)])
-&gt; [(NormalTerm, NormalTerm)]
-&gt; [(NormalTerm, NormalTerm)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NormalTerm, NormalTerm)
</span><a href="#local-6989586621679247488"><span class="hs-identifier hs-var">pair</span></a></span><span> </span><span class="annot"><span class="annottext">(NormalTerm, NormalTerm)
-&gt; [(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247489"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-comment">-- &gt;&gt;&gt; a = Variable &quot;a&quot;</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- &gt;&gt;&gt; b = Variable &quot;b&quot;</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- &gt;&gt;&gt; c = Variable &quot;c&quot;</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- &gt;&gt;&gt; f = Metavariable &quot;F&quot;</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- &gt;&gt;&gt; u = Variable &quot;u&quot;</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- &gt;&gt;&gt; v = Variable &quot;v&quot;</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- &gt;&gt;&gt; w = Variable &quot;w&quot;</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- &gt;&gt;&gt; x = Metavariable &quot;X&quot;</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- &gt;&gt;&gt; y = Metavariable &quot;Y&quot;</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- &gt;&gt;&gt; t = Base &quot;t&quot;</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- &gt;&gt;&gt; var v t = NormalTerm (Heading [] (AVar v)) [] t</span><span>
</span><span id="line-510"></span><span class="hs-comment">-- &gt;&gt;&gt; meta v t = NormalTerm (Heading [] (AMetavar v)) [] t</span><span>
</span><span id="line-511"></span><span class="hs-comment">--</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- &gt;&gt;&gt; left = NormalTerm (Heading [] (AVar a)) [NormalTerm (Heading [(u, t)] (AVar b)) [meta x t, var u t] t, var c t] t</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- &gt;&gt;&gt; right = NormalTerm (Heading [] (AVar a)) [NormalTerm (Heading [(v, t)] (AVar b)) [meta y t, var v t] t, NormalTerm (Heading [] (AMetavar f)) [var c t] t] t</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- &gt;&gt;&gt; simplify (DisagreementSet [(left, right)])</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- Just { &#955;u: t. X :: t = &#955;v: t. Y :: t; c :: t = F (c :: t) :: t }</span><span>
</span><span id="line-516"></span><span class="hs-comment">--</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- &gt;&gt;&gt; left = NormalTerm (Heading [] (AVar a)) [NormalTerm (Heading [(u, t)] (AVar b)) [meta x t, var u t] t] t</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- &gt;&gt;&gt; right = NormalTerm (Heading [] (AVar a)) [NormalTerm (Heading [(v, t)] (AVar b)) [meta y t, var v t] t] t</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- &gt;&gt;&gt; simplify (DisagreementSet [(left, right)])</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- Just { &#955;u: t. X :: t = &#955;v: t. Y :: t }</span><span>
</span><span id="line-521"></span><span class="hs-comment">--</span><span>
</span><span id="line-522"></span><span class="hs-comment">-- &gt;&gt;&gt; left = NormalTerm (Heading [(u, t), (v, t)] (AVar a)) [var u t, NormalTerm (Heading [(w, t)] (AVar v)) [] t] t</span><span>
</span><span id="line-523"></span><span class="hs-comment">-- &gt;&gt;&gt; right = NormalTerm (Heading [(v, t), (w, t)] (AVar a)) [var v t, NormalTerm (Heading [(u, t)] (AVar v)) [] t] t</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- &gt;&gt;&gt; simplify (DisagreementSet [(left, right)])</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- Nothing</span><span>
</span><span id="line-526"></span><span class="annot"><a href="Language.Lambda.Typed.html#simplify"><span class="hs-identifier hs-type">simplify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span>
</span><span id="line-527"></span><span id="simplify"><span class="annot"><span class="annottext">simplify :: DisagreementSet -&gt; Maybe DisagreementSet
</span><a href="Language.Lambda.Typed.html#simplify"><span class="hs-identifier hs-var hs-var">simplify</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-type">DisagreementSet</span></a></span><span> </span><span id="local-6989586621679247490"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247490"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; DisagreementSet
</span><a href="Language.Lambda.Typed.html#DisagreementSet"><span class="hs-identifier hs-var">DisagreementSet</span></a></span><span> </span><span class="annot"><span class="annottext">([(NormalTerm, NormalTerm)] -&gt; DisagreementSet)
-&gt; Maybe [(NormalTerm, NormalTerm)] -&gt; Maybe DisagreementSet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; Maybe [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247491"><span class="hs-identifier hs-var">simplifyRigidPairs</span></a></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247490"><span class="hs-identifier hs-var">set</span></a></span><span>
</span><span id="line-528"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-529"></span><span>  </span><span id="local-6989586621679247491"><span class="annot"><span class="annottext">simplifyRigidPairs :: [(NormalTerm, NormalTerm)] -&gt; Maybe [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247491"><span class="hs-identifier hs-var hs-var">simplifyRigidPairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((NormalTerm, NormalTerm)
 -&gt; Maybe [(NormalTerm, NormalTerm)]
 -&gt; Maybe [(NormalTerm, NormalTerm)])
-&gt; Maybe [(NormalTerm, NormalTerm)]
-&gt; [(NormalTerm, NormalTerm)]
-&gt; Maybe [(NormalTerm, NormalTerm)]
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">(NormalTerm, NormalTerm)
-&gt; Maybe [(NormalTerm, NormalTerm)]
-&gt; Maybe [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247499"><span class="hs-identifier hs-var">simplifyRigidPair</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; Maybe [(NormalTerm, NormalTerm)]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>  </span><span id="local-6989586621679247499"><span class="annot"><span class="annottext">simplifyRigidPair :: (NormalTerm, NormalTerm)
-&gt; Maybe [(NormalTerm, NormalTerm)]
-&gt; Maybe [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247499"><span class="hs-identifier hs-var hs-var">simplifyRigidPair</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Rigid"><span class="hs-identifier hs-type">Rigid</span></a></span><span> </span><span id="local-6989586621679247500"><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247500"><span class="hs-identifier hs-var">left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Rigid"><span class="hs-identifier hs-type">Rigid</span></a></span><span> </span><span id="local-6989586621679247501"><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247501"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679247502"><span class="annot"><span class="annottext">Maybe [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247502"><span class="hs-identifier hs-var">rest</span></a></span></span><span>
</span><span id="line-531"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Heading Variable -&gt; Heading Variable -&gt; Bool
</span><a href="Language.Lambda.Typed.html#areAlphaEquivalent"><span class="hs-identifier hs-var">areAlphaEquivalent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; Heading Variable
forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247500"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; Heading Variable
forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247501"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-532"></span><span>        </span><span id="local-6989586621679247503"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247503"><span class="hs-identifier hs-var">newPairs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; Maybe [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247491"><span class="hs-identifier hs-var">simplifyRigidPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[NormalTerm] -&gt; [NormalTerm] -&gt; [(NormalTerm, NormalTerm)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; [NormalTerm]
forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#scopedArguments"><span class="hs-identifier hs-var">scopedArguments</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247500"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; [NormalTerm]
forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#scopedArguments"><span class="hs-identifier hs-var">scopedArguments</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247501"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>        </span><span id="local-6989586621679247504"><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247504"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247502"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-534"></span><span>        </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)] -&gt; Maybe [(NormalTerm, NormalTerm)]
forall a. a -&gt; Maybe a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247503"><span class="hs-identifier hs-var">newPairs</span></a></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
-&gt; [(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247504"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [(NormalTerm, NormalTerm)]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-536"></span><span>  </span><span class="annot"><a href="#local-6989586621679247499"><span class="hs-identifier hs-var">simplifyRigidPair</span></a></span><span> </span><span id="local-6989586621679247505"><span class="annot"><span class="annottext">(NormalTerm, NormalTerm)
</span><a href="#local-6989586621679247505"><span class="hs-identifier hs-var">pair</span></a></span></span><span> </span><span id="local-6989586621679247506"><span class="annot"><span class="annottext">Maybe [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247506"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(NormalTerm, NormalTerm)
</span><a href="#local-6989586621679247505"><span class="hs-identifier hs-var">pair</span></a></span><span> </span><span class="annot"><span class="annottext">(NormalTerm, NormalTerm)
-&gt; [(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(NormalTerm, NormalTerm)] -&gt; [(NormalTerm, NormalTerm)])
-&gt; Maybe [(NormalTerm, NormalTerm)]
-&gt; Maybe [(NormalTerm, NormalTerm)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe [(NormalTerm, NormalTerm)]
</span><a href="#local-6989586621679247506"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="hs-keyword">data</span><span> </span><span id="Stream"><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-var">Stream</span></a></span></span><span> </span><span id="local-6989586621679246834"><span class="annot"><a href="#local-6989586621679246834"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Stream"><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-var">Stream</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679246834"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246834"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247510"><span id="local-6989586621679247515"><span class="annot"><span class="annottext">Stream a -&gt; Stream a -&gt; Bool
(Stream a -&gt; Stream a -&gt; Bool)
-&gt; (Stream a -&gt; Stream a -&gt; Bool) -&gt; Eq (Stream a)
forall a. Eq a =&gt; Stream a -&gt; Stream a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; Stream a -&gt; Stream a -&gt; Bool
== :: Stream a -&gt; Stream a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Stream a -&gt; Stream a -&gt; Bool
/= :: Stream a -&gt; Stream a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247519"><span id="local-6989586621679247525"><span id="local-6989586621679247528"><span class="annot"><span class="annottext">Int -&gt; Stream a -&gt; ShowS
[Stream a] -&gt; ShowS
Stream a -&gt; String
(Int -&gt; Stream a -&gt; ShowS)
-&gt; (Stream a -&gt; String) -&gt; ([Stream a] -&gt; ShowS) -&gt; Show (Stream a)
forall a. Show a =&gt; Int -&gt; Stream a -&gt; ShowS
forall a. Show a =&gt; [Stream a] -&gt; ShowS
forall a. Show a =&gt; Stream a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Stream a -&gt; ShowS
showsPrec :: Int -&gt; Stream a -&gt; ShowS
$cshow :: forall a. Show a =&gt; Stream a -&gt; String
show :: Stream a -&gt; String
$cshowList :: forall a. Show a =&gt; [Stream a] -&gt; ShowS
showList :: [Stream a] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247531"><span id="local-6989586621679247534"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Stream a -&gt; Stream b)
-&gt; (forall a b. a -&gt; Stream b -&gt; Stream a) -&gt; Functor Stream
forall a b. a -&gt; Stream b -&gt; Stream a
forall a b. (a -&gt; b) -&gt; Stream a -&gt; Stream b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; Stream a -&gt; Stream b
fmap :: forall a b. (a -&gt; b) -&gt; Stream a -&gt; Stream b
$c&lt;$ :: forall a b. a -&gt; Stream b -&gt; Stream a
&lt;$ :: forall a b. a -&gt; Stream b -&gt; Stream a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span id="local-6989586621679246830"><span id="local-6989586621679246831"><span class="annot"><a href="Language.Lambda.Typed.html#zipWithList"><span class="hs-identifier hs-type">zipWithList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246830"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679246831"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246830"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679246830"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679246831"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-541"></span><span id="zipWithList"><span class="annot"><span class="annottext">zipWithList :: forall a b. Stream a -&gt; [b] -&gt; (Stream a, [(a, b)])
</span><a href="Language.Lambda.Typed.html#zipWithList"><span class="hs-identifier hs-var hs-var">zipWithList</span></a></span></span><span> </span><span id="local-6989586621679247538"><span class="annot"><span class="annottext">Stream a
</span><a href="#local-6989586621679247538"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream a
</span><a href="#local-6989586621679247538"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span class="annot"><a href="Language.Lambda.Typed.html#zipWithList"><span class="hs-identifier hs-var">zipWithList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span id="local-6989586621679247539"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247539"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679247540"><span class="annot"><span class="annottext">Stream a
</span><a href="#local-6989586621679247540"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247541"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679247541"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679247542"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679247542"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stream a
</span><a href="#local-6989586621679247543"><span class="hs-identifier hs-var">as'</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679247539"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679247541"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679247544"><span class="hs-identifier hs-var">bs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679247543"><span class="annot"><span class="annottext">Stream a
</span><a href="#local-6989586621679247543"><span class="hs-identifier hs-var">as'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247544"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679247544"><span class="hs-identifier hs-var">bs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream a -&gt; [b] -&gt; (Stream a, [(a, b)])
forall a b. Stream a -&gt; [b] -&gt; (Stream a, [(a, b)])
</span><a href="Language.Lambda.Typed.html#zipWithList"><span class="hs-identifier hs-var">zipWithList</span></a></span><span> </span><span class="annot"><span class="annottext">Stream a
</span><a href="#local-6989586621679247540"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679247542"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-545"></span><span>
</span><span id="line-546"></span><span class="annot"><a href="Language.Lambda.Typed.html#integers"><span class="hs-identifier hs-type">integers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-547"></span><span id="integers"><span class="annot"><span class="annottext">integers :: Int -&gt; Stream Int
</span><a href="Language.Lambda.Typed.html#integers"><span class="hs-identifier hs-var hs-var">integers</span></a></span></span><span> </span><span id="local-6989586621679247546"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247546"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Stream Int -&gt; Stream Int
forall a. a -&gt; Stream a -&gt; Stream a
</span><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-var">Stream</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247546"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Stream Int
</span><a href="Language.Lambda.Typed.html#integers"><span class="hs-identifier hs-var">integers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247546"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-548"></span><span>
</span><span id="line-549"></span><span class="annot"><a href="Language.Lambda.Typed.html#someMetavariables"><span class="hs-identifier hs-type">someMetavariables</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span>
</span><span id="line-550"></span><span id="someMetavariables"><span class="annot"><span class="annottext">someMetavariables :: Stream Metavariable
</span><a href="Language.Lambda.Typed.html#someMetavariables"><span class="hs-identifier hs-var hs-var">someMetavariables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Metavariable) -&gt; Stream Int -&gt; Stream Metavariable
forall a b. (a -&gt; b) -&gt; Stream a -&gt; Stream b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679247547"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247547"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Metavariable
</span><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-var">Metavariable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;M&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247547"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Stream Int
</span><a href="Language.Lambda.Typed.html#integers"><span class="hs-identifier hs-var">integers</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="annot"><a href="Language.Lambda.Typed.html#someVariables"><span class="hs-identifier hs-type">someVariables</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span>
</span><span id="line-553"></span><span id="someVariables"><span class="annot"><span class="annottext">someVariables :: Stream Variable
</span><a href="Language.Lambda.Typed.html#someVariables"><span class="hs-identifier hs-var hs-var">someVariables</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Variable) -&gt; Stream Int -&gt; Stream Variable
forall a b. (a -&gt; b) -&gt; Stream a -&gt; Stream b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679247548"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247548"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Variable
</span><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-var">Variable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;v&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247548"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Stream Int
</span><a href="Language.Lambda.Typed.html#integers"><span class="hs-identifier hs-var">integers</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-comment">-- &gt;&gt;&gt; t = Base &quot;t&quot;</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- &gt;&gt;&gt; _M = Metavariable &quot;M&quot;</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- &gt;&gt;&gt; a = Variable &quot;a&quot;</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- &gt;&gt;&gt; b = Variable &quot;b&quot;</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- &gt;&gt;&gt; c = Variable &quot;c&quot;</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- &gt;&gt;&gt; show' = fmap (\(x, _, _) -&gt; x)</span><span>
</span><span id="line-561"></span><span class="hs-comment">--</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- &gt;&gt;&gt; show' $ match (Term [(a, t)] _M [] t) (var a t) someVariables someMetavariables</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- []</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- &gt;&gt;&gt; show' $ match (var _M t) (var a t) someVariables someMetavariables</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- [a :: t]</span><span>
</span><span id="line-566"></span><span class="hs-comment">-- &gt;&gt;&gt; show' $ match (var _M t) (apply a [var (AVar b) t] t) someVariables someMetavariables</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- [a (M0 :: t) :: t]</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- &gt;&gt;&gt; show' $ match (apply _M [var (AVar b) t] t) (var a t) someVariables someMetavariables</span><span>
</span><span id="line-569"></span><span class="hs-comment">-- [&#955;v0: t. a :: t,&#955;v0: t. v0 :: t]</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- &gt;&gt;&gt; show' $ match (apply _M [var (AVar b) t] t) (Term [(b, t)] a [var (AVar c) t] t) someVariables someMetavariables</span><span>
</span><span id="line-571"></span><span class="hs-comment">-- [&#955;v0: t, v1: t. a (M0 (v0 :: t) (v1 :: t) :: t) :: t,&#955;v0: t. v0 :: t,&#955;v0: t, v1: t. v0 :: t]</span><span>
</span><span id="line-572"></span><span class="hs-comment">-- &gt;&gt;&gt; show' $ match (apply _M [apply (AVar b) [var (AVar a) (Function t t)] t] t) (apply a [apply (AVar b) [var (AMetavar _M) (Function t t)] t] t) someVariables someMetavariables</span><span>
</span><span id="line-573"></span><span class="hs-comment">-- [a :: t -&gt; t,&#955;v0: t. a (M0 (v0 :: t) :: t) :: t,&#955;v0: t. v0 :: t]</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- &gt;&gt;&gt; show' $ match (var _M (Function t (Function t t))) (Term [(a, t), (b, t)] a [] t) someVariables someMetavariables</span><span>
</span><span id="line-575"></span><span class="hs-comment">-- [&#955;v0: t, v1: t. v0 :: t]</span><span>
</span><span id="line-576"></span><span class="annot"><a href="Language.Lambda.Typed.html#match"><span class="hs-identifier hs-type">match</span></a></span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#FlexibleTerm"><span class="hs-identifier hs-type">FlexibleTerm</span></a></span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#RigidTerm"><span class="hs-identifier hs-type">RigidTerm</span></a></span><span>
</span><span id="line-579"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-582"></span><span id="match"><span class="annot"><span class="annottext">match :: FlexibleTerm
-&gt; RigidTerm
-&gt; Stream Variable
-&gt; Stream Metavariable
-&gt; [(NormalTerm, Stream Variable, Stream Metavariable)]
</span><a href="Language.Lambda.Typed.html#match"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span id="local-6989586621679247549"><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247549"><span class="hs-identifier hs-var">flexible</span></a></span></span><span> </span><span id="local-6989586621679247550"><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247550"><span class="hs-identifier hs-var">rigid</span></a></span></span><span> </span><span id="local-6989586621679247551"><span class="annot"><span class="annottext">Stream Variable
</span><a href="#local-6989586621679247551"><span class="hs-identifier hs-var">variables</span></a></span></span><span> </span><span id="local-6989586621679247552"><span class="annot"><span class="annottext">Stream Metavariable
</span><a href="#local-6989586621679247552"><span class="hs-identifier hs-var">metavariables</span></a></span></span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247553"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-584"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, Stream Variable, Stream Metavariable)]
</span><a href="#local-6989586621679247555"><span class="hs-identifier hs-var">imitate</span></a></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, Stream Variable, Stream Metavariable)]
-&gt; [(NormalTerm, Stream Variable, Stream Metavariable)]
-&gt; [(NormalTerm, Stream Variable, Stream Metavariable)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(NormalTerm, Stream Variable, Stream Metavariable)]
</span><a href="#local-6989586621679247556"><span class="hs-identifier hs-var">project</span></a></span><span>
</span><span id="line-585"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-586"></span><span>  </span><span id="local-6989586621679247558"><span class="annot"><span class="annottext">nFlexible :: Int
</span><a href="#local-6989586621679247558"><span class="hs-identifier hs-var hs-var">nFlexible</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Heading Metavariable -&gt; [(Variable, Type)]
forall head. Heading head -&gt; [(Variable, Type)]
</span><a href="Language.Lambda.Typed.html#binder"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexibleTerm -&gt; Heading Metavariable
forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247549"><span class="hs-identifier hs-var">flexible</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>  </span><span id="local-6989586621679247560"><span class="annot"><span class="annottext">nRigid :: Int
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var hs-var">nRigid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Heading Variable -&gt; [(Variable, Type)]
forall head. Heading head -&gt; [(Variable, Type)]
</span><a href="Language.Lambda.Typed.html#binder"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; Heading Variable
forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247550"><span class="hs-identifier hs-var">rigid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>  </span><span id="local-6989586621679247553"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679247553"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247560"><span class="hs-identifier hs-var">nRigid</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247558"><span class="hs-identifier hs-var">nFlexible</span></a></span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span>  </span><span id="local-6989586621679247563"><span class="annot"><span class="annottext">pFlexible :: Int
</span><a href="#local-6989586621679247563"><span class="hs-identifier hs-var hs-var">pFlexible</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NormalTerm] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexibleTerm -&gt; [NormalTerm]
forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247549"><span class="hs-identifier hs-var">flexible</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>  </span><span id="local-6989586621679247565"><span class="annot"><span class="annottext">pRigid :: Int
</span><a href="#local-6989586621679247565"><span class="hs-identifier hs-var hs-var">pRigid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[NormalTerm] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; [NormalTerm]
forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247550"><span class="hs-identifier hs-var">rigid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>
</span><span id="line-593"></span><span>  </span><span id="local-6989586621679247555"><span class="annot"><span class="annottext">imitate :: [(NormalTerm, Stream Variable, Stream Metavariable)]
</span><a href="#local-6989586621679247555"><span class="hs-identifier hs-var hs-var">imitate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-594"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Heading Variable -&gt; Int -&gt; Maybe (Either Int Variable)
</span><a href="Language.Lambda.Typed.html#imitatableHead"><span class="hs-identifier hs-var">imitatableHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; Heading Variable
forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247550"><span class="hs-identifier hs-var">rigid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247558"><span class="hs-identifier hs-var">nFlexible</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-595"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Either Int Variable)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-596"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679247568"><span class="annot"><span class="annottext">Either Int Variable
</span><a href="#local-6989586621679247568"><span class="hs-identifier hs-var">head</span></a></span></span><span>
</span><span id="line-597"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247553"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Either Int Variable
-&gt; (NormalTerm, Stream Variable, Stream Metavariable)
</span><a href="#local-6989586621679247570"><span class="hs-identifier hs-var">imitateWithExtendedBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Either Int Variable
</span><a href="#local-6989586621679247568"><span class="hs-identifier hs-var">head</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Int Variable
-&gt; [(NormalTerm, Stream Variable, Stream Metavariable)]
forall {a}.
Either a Variable
-&gt; [(NormalTerm, Stream Variable, Stream Metavariable)]
</span><a href="#local-6989586621679247571"><span class="hs-identifier hs-var">imitateDirectly</span></a></span><span> </span><span class="annot"><span class="annottext">Either Int Variable
</span><a href="#local-6989586621679247568"><span class="hs-identifier hs-var">head</span></a></span><span>
</span><span id="line-599"></span><span>
</span><span id="line-600"></span><span>  </span><span id="local-6989586621679247570"><span class="annot"><span class="annottext">imitateWithExtendedBinder :: Either Int Variable
-&gt; (NormalTerm, Stream Variable, Stream Metavariable)
</span><a href="#local-6989586621679247570"><span class="hs-identifier hs-var hs-var">imitateWithExtendedBinder</span></a></span></span><span> </span><span id="local-6989586621679247572"><span class="annot"><span class="annottext">Either Int Variable
</span><a href="#local-6989586621679247572"><span class="hs-identifier hs-var">head</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-601"></span><span>    </span><span class="annot"><span class="annottext">[Type]
-&gt; ([Variable] -&gt; Variable)
-&gt; [Type]
-&gt; Type
-&gt; (NormalTerm, Stream Variable, Stream Metavariable)
</span><a href="#local-6989586621679247573"><span class="hs-identifier hs-var">makeSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247574"><span class="hs-identifier hs-var">binderTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Variable] -&gt; Variable
</span><a href="#local-6989586621679247575"><span class="hs-identifier hs-var">head'</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247576"><span class="hs-identifier hs-var">argumentTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; Type
forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#returnType"><span class="hs-identifier hs-var">returnType</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247550"><span class="hs-identifier hs-var">rigid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-603"></span><span>    </span><span id="local-6989586621679247574"><span class="annot"><span class="annottext">binderTypes :: [Type]
</span><a href="#local-6989586621679247574"><span class="hs-identifier hs-var hs-var">binderTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247578"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247579"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-604"></span><span>    </span><span id="local-6989586621679247578"><span class="annot"><span class="annottext">ws :: [Type]
</span><a href="#local-6989586621679247578"><span class="hs-identifier hs-var hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NormalTerm -&gt; Type
forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#typeOfTerm"><span class="hs-identifier hs-var">typeOfTerm</span></a></span><span> </span><span class="annot"><span class="annottext">(NormalTerm -&gt; Type) -&gt; [NormalTerm] -&gt; [Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm -&gt; [NormalTerm]
forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247549"><span class="hs-identifier hs-var">flexible</span></a></span><span>
</span><span id="line-605"></span><span>    </span><span id="local-6989586621679247579"><span class="annot"><span class="annottext">vs :: [Type]
</span><a href="#local-6989586621679247579"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Variable, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Variable, Type) -&gt; Type) -&gt; [(Variable, Type)] -&gt; [Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Variable, Type)] -&gt; [(Variable, Type)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247558"><span class="hs-identifier hs-var">nFlexible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Heading Variable -&gt; [(Variable, Type)]
forall head. Heading head -&gt; [(Variable, Type)]
</span><a href="Language.Lambda.Typed.html#binder"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; Heading Variable
forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247550"><span class="hs-identifier hs-var">rigid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>    </span><span id="local-6989586621679247576"><span class="annot"><span class="annottext">argumentTypes :: [Type]
</span><a href="#local-6989586621679247576"><span class="hs-identifier hs-var hs-var">argumentTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NormalTerm -&gt; Type
forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#typeOfTerm"><span class="hs-identifier hs-var">typeOfTerm</span></a></span><span> </span><span class="annot"><span class="annottext">(NormalTerm -&gt; Type) -&gt; [NormalTerm] -&gt; [Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RigidTerm -&gt; [NormalTerm]
forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247550"><span class="hs-identifier hs-var">rigid</span></a></span><span>
</span><span id="line-607"></span><span>    </span><span id="local-6989586621679247575"><span class="annot"><span class="annottext">head' :: [Variable] -&gt; Variable
</span><a href="#local-6989586621679247575"><span class="hs-identifier hs-var hs-var">head'</span></a></span></span><span>
</span><span id="line-608"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679247588"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247588"><span class="hs-identifier hs-var">constant</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either Int Variable
</span><a href="#local-6989586621679247572"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Variable -&gt; [Variable] -&gt; Variable
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247588"><span class="hs-identifier hs-var">constant</span></a></span><span>
</span><span id="line-609"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679247590"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247590"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either Int Variable
</span><a href="#local-6989586621679247572"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Variable] -&gt; Int -&gt; Variable
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247563"><span class="hs-identifier hs-var">pFlexible</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247590"><span class="hs-identifier hs-var">offset</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span>  </span><span id="local-6989586621679247571"><span class="annot"><span class="annottext">imitateDirectly :: Either a Variable
-&gt; [(NormalTerm, Stream Variable, Stream Metavariable)]
</span><a href="#local-6989586621679247571"><span class="hs-identifier hs-var hs-var">imitateDirectly</span></a></span></span><span> </span><span id="local-6989586621679247603"><span class="annot"><span class="annottext">Either a Variable
</span><a href="#local-6989586621679247603"><span class="hs-identifier hs-var">head</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-612"></span><span>    </span><span id="local-6989586621679247604"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247604"><span class="hs-identifier hs-var">head'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either a Variable
</span><a href="#local-6989586621679247603"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-613"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679247605"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247605"><span class="hs-identifier hs-var">head'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Variable -&gt; [Variable]
forall a. a -&gt; [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247605"><span class="hs-identifier hs-var">head'</span></a></span><span>
</span><span id="line-614"></span><span>      </span><span class="hs-comment">-- A bound argument? In my direct imitation?</span><span>
</span><span id="line-615"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-616"></span><span>    </span><span id="local-6989586621679247606"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247606"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247563"><span class="hs-identifier hs-var">pFlexible</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247565"><span class="hs-identifier hs-var">pRigid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247563"><span class="hs-identifier hs-var">pFlexible</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247609"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247609"><span class="hs-identifier hs-var">takenFlexible</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247610"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247610"><span class="hs-identifier hs-var">remainingFlexible</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-619"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; ([Type], [Type])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247606"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalTerm -&gt; Type
forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#typeOfTerm"><span class="hs-identifier hs-var">typeOfTerm</span></a></span><span> </span><span class="annot"><span class="annottext">(NormalTerm -&gt; Type) -&gt; [NormalTerm] -&gt; [Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm -&gt; [NormalTerm]
forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247549"><span class="hs-identifier hs-var">flexible</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247615"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247615"><span class="hs-identifier hs-var">takenRigid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247616"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247616"><span class="hs-identifier hs-var">remainingRigid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-621"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; ([Type], [Type])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247565"><span class="hs-identifier hs-var">pRigid</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247563"><span class="hs-identifier hs-var">pFlexible</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247606"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalTerm -&gt; Type
forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#typeOfTerm"><span class="hs-identifier hs-var">typeOfTerm</span></a></span><span> </span><span class="annot"><span class="annottext">(NormalTerm -&gt; Type) -&gt; [NormalTerm] -&gt; [Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">RigidTerm -&gt; [NormalTerm]
forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247550"><span class="hs-identifier hs-var">rigid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247618"><span class="annot"><span class="annottext">returnType' :: Type
</span><a href="#local-6989586621679247618"><span class="hs-identifier hs-var hs-var">returnType'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type -&gt; Type) -&gt; Type -&gt; [Type] -&gt; Type
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Type
</span><a href="Language.Lambda.Typed.html#Function"><span class="hs-identifier hs-var">Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; Type
forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#returnType"><span class="hs-identifier hs-var">returnType</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247550"><span class="hs-identifier hs-var">rigid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247616"><span class="hs-identifier hs-var">remainingRigid</span></a></span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247610"><span class="hs-identifier hs-var">remainingFlexible</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247616"><span class="hs-identifier hs-var">remainingRigid</span></a></span><span>
</span><span id="line-625"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(NormalTerm, Stream Variable, Stream Metavariable)
-&gt; [(NormalTerm, Stream Variable, Stream Metavariable)]
forall a. a -&gt; [a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Type]
-&gt; ([Variable] -&gt; Variable)
-&gt; [Type]
-&gt; Type
-&gt; (NormalTerm, Stream Variable, Stream Metavariable)
</span><a href="#local-6989586621679247573"><span class="hs-identifier hs-var">makeSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247609"><span class="hs-identifier hs-var">takenFlexible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Variable -&gt; [Variable] -&gt; Variable
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247604"><span class="hs-identifier hs-var">head'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247615"><span class="hs-identifier hs-var">takenRigid</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247618"><span class="hs-identifier hs-var">returnType'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span>  </span><span id="local-6989586621679247556"><span class="annot"><span class="annottext">project :: [(NormalTerm, Stream Variable, Stream Metavariable)]
</span><a href="#local-6989586621679247556"><span class="hs-identifier hs-var hs-var">project</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247632"><span class="annot"><span class="annottext">ws :: [Type]
</span><a href="#local-6989586621679247632"><span class="hs-identifier hs-var hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NormalTerm -&gt; Type
forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#typeOfTerm"><span class="hs-identifier hs-var">typeOfTerm</span></a></span><span> </span><span class="annot"><span class="annottext">(NormalTerm -&gt; Type) -&gt; [NormalTerm] -&gt; [Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm -&gt; [NormalTerm]
forall head. NormalTerm' head -&gt; [NormalTerm]
</span><a href="Language.Lambda.Typed.html#arguments"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247549"><span class="hs-identifier hs-var">flexible</span></a></span><span>
</span><span id="line-630"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247634"><span class="annot"><span class="annottext">vs :: [Type]
</span><a href="#local-6989586621679247634"><span class="hs-identifier hs-var hs-var">vs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Variable, Type) -&gt; Type
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((Variable, Type) -&gt; Type) -&gt; [(Variable, Type)] -&gt; [Type]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Variable, Type)] -&gt; [(Variable, Type)]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247558"><span class="hs-identifier hs-var">nFlexible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Heading Variable -&gt; [(Variable, Type)]
forall head. Heading head -&gt; [(Variable, Type)]
</span><a href="Language.Lambda.Typed.html#binder"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RigidTerm -&gt; Heading Variable
forall head. NormalTerm' head -&gt; Heading head
</span><a href="Language.Lambda.Typed.html#heading"><span class="hs-identifier hs-var">heading</span></a></span><span> </span><span class="annot"><span class="annottext">RigidTerm
</span><a href="#local-6989586621679247550"><span class="hs-identifier hs-var">rigid</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247636"><span class="annot"><span class="annottext">wholeBinderTypes :: [Type]
</span><a href="#local-6989586621679247636"><span class="hs-identifier hs-var hs-var">wholeBinderTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247632"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; [Type] -&gt; [Type]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247634"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span>    </span><span id="local-6989586621679247637"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247637"><span class="hs-identifier hs-var">nSubstitution</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247563"><span class="hs-identifier hs-var">pFlexible</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247553"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-634"></span><span>    </span><span id="local-6989586621679247638"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247638"><span class="hs-identifier hs-var">projectOn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247637"><span class="hs-identifier hs-var">nSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247563"><span class="hs-identifier hs-var">pFlexible</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247640"><span class="annot"><span class="annottext">binderTypes :: [Type]
</span><a href="#local-6989586621679247640"><span class="hs-identifier hs-var hs-var">binderTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Type] -&gt; [Type]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247637"><span class="hs-identifier hs-var">nSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247636"><span class="hs-identifier hs-var">wholeBinderTypes</span></a></span><span>
</span><span id="line-637"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247644"><span class="annot"><span class="annottext">projectedType :: Type
</span><a href="#local-6989586621679247644"><span class="hs-identifier hs-var hs-var">projectedType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247640"><span class="hs-identifier hs-var">binderTypes</span></a></span><span> </span><span class="annot"><span class="annottext">[Type] -&gt; Int -&gt; Type
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247638"><span class="hs-identifier hs-var">projectOn</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679247645"><span class="annot"><span class="annottext">returnType' :: Type
</span><a href="#local-6989586621679247645"><span class="hs-identifier hs-var hs-var">returnType'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Type -&gt; Type
</span><a href="Language.Lambda.Typed.html#dropParameters"><span class="hs-identifier hs-var">dropParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247637"><span class="hs-identifier hs-var">nSubstitution</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FlexibleTerm -&gt; Type
forall head. NormalTerm' head -&gt; Type
</span><a href="Language.Lambda.Typed.html#typeOfHead"><span class="hs-identifier hs-var">typeOfHead</span></a></span><span> </span><span class="annot"><span class="annottext">FlexibleTerm
</span><a href="#local-6989586621679247549"><span class="hs-identifier hs-var">flexible</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Maybe [Type]
</span><a href="Language.Lambda.Typed.html#getExtraParameters"><span class="hs-identifier hs-var">getExtraParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247645"><span class="hs-identifier hs-var">returnType'</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247644"><span class="hs-identifier hs-var">projectedType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-641"></span><span>      </span><span class="annot"><span class="annottext">Maybe [Type]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-642"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679247646"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247646"><span class="hs-identifier hs-var">extraParameters</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-643"></span><span>        </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Type]
-&gt; ([Variable] -&gt; Variable)
-&gt; [Type]
-&gt; Type
-&gt; (NormalTerm, Stream Variable, Stream Metavariable)
</span><a href="#local-6989586621679247573"><span class="hs-identifier hs-var">makeSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247640"><span class="hs-identifier hs-var">binderTypes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Variable] -&gt; Int -&gt; Variable
forall a. HasCallStack =&gt; [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679247638"><span class="hs-identifier hs-var">projectOn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247646"><span class="hs-identifier hs-var">extraParameters</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247645"><span class="hs-identifier hs-var">returnType'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>  </span><span class="annot"><a href="#local-6989586621679247573"><span class="hs-identifier hs-type">makeSubstitution</span></a></span><span>
</span><span id="line-646"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-647"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-648"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-649"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-650"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Language.Lambda.Typed.html#NormalTerm"><span class="hs-identifier hs-type">NormalTerm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Variable"><span class="hs-identifier hs-type">Variable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Stream"><span class="hs-identifier hs-type">Stream</span></a></span><span> </span><span class="annot"><a href="Language.Lambda.Typed.html#Metavariable"><span class="hs-identifier hs-type">Metavariable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>  </span><span id="local-6989586621679247573"><span class="annot"><span class="annottext">makeSubstitution :: [Type]
-&gt; ([Variable] -&gt; Variable)
-&gt; [Type]
-&gt; Type
-&gt; (NormalTerm, Stream Variable, Stream Metavariable)
</span><a href="#local-6989586621679247573"><span class="hs-identifier hs-var hs-var">makeSubstitution</span></a></span></span><span> </span><span id="local-6989586621679247647"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247647"><span class="hs-identifier hs-var">binderTypes</span></a></span></span><span> </span><span id="local-6989586621679247648"><span class="annot"><span class="annottext">[Variable] -&gt; Variable
</span><a href="#local-6989586621679247648"><span class="hs-identifier hs-var">head</span></a></span></span><span> </span><span id="local-6989586621679247649"><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247649"><span class="hs-identifier hs-var">argumentTypes</span></a></span></span><span> </span><span id="local-6989586621679247650"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247650"><span class="hs-identifier hs-var">returnType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-652"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NormalTerm
</span><a href="#local-6989586621679247651"><span class="hs-identifier hs-var">term</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stream Variable
</span><a href="#local-6989586621679247652"><span class="hs-identifier hs-var">variables'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Stream Metavariable
</span><a href="#local-6989586621679247653"><span class="hs-identifier hs-var">metavariables'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-654"></span><span>    </span><span id="local-6989586621679247651"><span class="annot"><span class="annottext">term :: NormalTerm
</span><a href="#local-6989586621679247651"><span class="hs-identifier hs-var hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)] -&gt; Atom -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm
forall head.
[(Variable, Type)]
-&gt; head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#Term"><span class="hs-identifier hs-var">Term</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247655"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Variable -&gt; Atom
</span><a href="Language.Lambda.Typed.html#AVar"><span class="hs-identifier hs-var">AVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Variable] -&gt; Variable
</span><a href="#local-6989586621679247648"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Variable, Type) -&gt; Variable
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Variable, Type) -&gt; Variable) -&gt; [(Variable, Type)] -&gt; [Variable]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247655"><span class="hs-identifier hs-var">binder</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247657"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247650"><span class="hs-identifier hs-var">returnType</span></a></span><span>
</span><span id="line-655"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679247652"><span class="annot"><span class="annottext">Stream Variable
</span><a href="#local-6989586621679247652"><span class="hs-identifier hs-var">variables'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247655"><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247655"><span class="hs-identifier hs-var">binder</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream Variable -&gt; [Type] -&gt; (Stream Variable, [(Variable, Type)])
forall a b. Stream a -&gt; [b] -&gt; (Stream a, [(a, b)])
</span><a href="Language.Lambda.Typed.html#zipWithList"><span class="hs-identifier hs-var">zipWithList</span></a></span><span> </span><span class="annot"><span class="annottext">Stream Variable
</span><a href="#local-6989586621679247551"><span class="hs-identifier hs-var">variables</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247647"><span class="hs-identifier hs-var">binderTypes</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span id="local-6989586621679247659"><span class="annot"><span class="annottext">propagatedBinder :: [NormalTerm]
</span><a href="#local-6989586621679247659"><span class="hs-identifier hs-var hs-var">propagatedBinder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-657"></span><span>      </span><span class="annot"><span class="annottext">[(Variable, Type)]
</span><a href="#local-6989586621679247655"><span class="hs-identifier hs-var">binder</span></a></span><span> </span><span class="annot"><span class="annottext">[(Variable, Type)]
-&gt; ((Variable, Type) -&gt; NormalTerm) -&gt; [NormalTerm]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679247660"><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247660"><span class="hs-identifier hs-var">parameter</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247661"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247661"><span class="hs-identifier hs-var">parameterType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-658"></span><span>        </span><span class="annot"><span class="annottext">Atom -&gt; Type -&gt; NormalTerm
forall head. head -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#var"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Variable -&gt; Atom
</span><a href="Language.Lambda.Typed.html#AVar"><span class="hs-identifier hs-var">AVar</span></a></span><span> </span><span class="annot"><span class="annottext">Variable
</span><a href="#local-6989586621679247660"><span class="hs-identifier hs-var">parameter</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247661"><span class="hs-identifier hs-var">parameterType</span></a></span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679247653"><span class="annot"><span class="annottext">Stream Metavariable
</span><a href="#local-6989586621679247653"><span class="hs-identifier hs-var">metavariables'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247662"><span class="annot"><span class="annottext">[(Metavariable, Type)]
</span><a href="#local-6989586621679247662"><span class="hs-identifier hs-var">hs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stream Metavariable
-&gt; [Type] -&gt; (Stream Metavariable, [(Metavariable, Type)])
forall a b. Stream a -&gt; [b] -&gt; (Stream a, [(a, b)])
</span><a href="Language.Lambda.Typed.html#zipWithList"><span class="hs-identifier hs-var">zipWithList</span></a></span><span> </span><span class="annot"><span class="annottext">Stream Metavariable
</span><a href="#local-6989586621679247552"><span class="hs-identifier hs-var">metavariables</span></a></span><span> </span><span class="annot"><span class="annottext">[Type]
</span><a href="#local-6989586621679247649"><span class="hs-identifier hs-var">argumentTypes</span></a></span><span>
</span><span id="line-661"></span><span>    </span><span id="local-6989586621679247657"><span class="annot"><span class="annottext">arguments :: [NormalTerm]
</span><a href="#local-6989586621679247657"><span class="hs-identifier hs-var hs-var">arguments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-662"></span><span>      </span><span class="annot"><span class="annottext">[(Metavariable, Type)]
</span><a href="#local-6989586621679247662"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Metavariable, Type)]
-&gt; ((Metavariable, Type) -&gt; NormalTerm) -&gt; [NormalTerm]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679247664"><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247664"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679247665"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247665"><span class="hs-identifier hs-var">argumentType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-663"></span><span>        </span><span class="annot"><span class="annottext">Atom -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm
forall head. head -&gt; [NormalTerm] -&gt; Type -&gt; NormalTerm' head
</span><a href="Language.Lambda.Typed.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Metavariable -&gt; Atom
</span><a href="Language.Lambda.Typed.html#AMetavar"><span class="hs-identifier hs-var">AMetavar</span></a></span><span> </span><span class="annot"><span class="annottext">Metavariable
</span><a href="#local-6989586621679247664"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NormalTerm]
</span><a href="#local-6989586621679247659"><span class="hs-identifier hs-var">propagatedBinder</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679247665"><span class="hs-identifier hs-var">argumentType</span></a></span><span>
</span><span id="line-664"></span></pre></body></html>