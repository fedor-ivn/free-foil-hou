<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">{- |
Module                  : Toml.Parser.Validate
Copyright               : (c) 2018-2022 Kowainik
SPDX-License-Identifier : MPL-2.0
Maintainer              : Kowainik &lt;xrom.xkov@gmail.com&gt;
Stability               : Stable
Portability             : Portable

This module contains functions that aggregate the result of
'Toml.Parser.Item.tomlP' parser into 'TOML'. This approach allows to keep parser
fast and simple and delegate the process of creating tree structure to a
separate function.

@since 1.2.0.0
-}</span></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Toml.Parser.Validate</span><span>
</span><span id="line-18"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Decoding</span></span><span>
</span><span id="line-19"></span><span>         </span><span class="annot"><a href="Toml.Parser.Validate.html#validateItems"><span class="hs-identifier">validateItems</span></a></span><span>
</span><span id="line-20"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Toml.Parser.Validate.html#ValidationError"><span class="hs-identifier">ValidationError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>         </span><span class="annot"><span class="hs-comment">-- * Internal helpers</span></span><span>
</span><span id="line-23"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Toml.Parser.Validate.html#groupItems"><span class="hs-identifier">groupItems</span></a></span><span>
</span><span id="line-24"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Toml.Parser.Validate.html#groupWithParent"><span class="hs-identifier">groupWithParent</span></a></span><span>
</span><span id="line-25"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Toml.Parser.Validate.html#validateItemForest"><span class="hs-identifier">validateItemForest</span></a></span><span>
</span><span id="line-26"></span><span>       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tree</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Forest</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Tree</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Toml.Parser.Item.html"><span class="hs-identifier">Toml.Parser.Item</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Toml.Parser.Item.html#Table"><span class="hs-identifier">Table</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier">TomlItem</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Toml.Parser.Item.html#setTableName"><span class="hs-identifier">setTableName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Toml.Type.Key.html"><span class="hs-identifier">Toml.Type.Key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Toml.Type.Key.html#Key"><span class="hs-identifier">Key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Toml.Type.Key.html#KeysDiff"><span class="hs-identifier">KeysDiff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Toml.Type.Key.html#FstIsPref"><span class="hs-identifier">FstIsPref</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Toml.Type.Key.html#keysDiff"><span class="hs-identifier">keysDiff</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Toml.Type.TOML.html"><span class="hs-identifier">Toml.Type.TOML</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Toml.Type.TOML.html#TOML"><span class="hs-identifier">TOML</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Toml.Type.TOML.html#insertKeyAnyVal"><span class="hs-identifier">insertKeyAnyVal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Toml.Type.TOML.html#insertTable"><span class="hs-identifier">insertTable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Toml.Type.TOML.html#insertTableArrays"><span class="hs-identifier">insertTableArrays</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashMap.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HashMap</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Toml.Type.PrefixTree.html"><span class="hs-identifier">Toml.Type.PrefixTree</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PrefixMap</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="annot"><span class="hs-comment">{- | Validate list of 'TomlItem's and convert to 'TOML' if not validation
errors are found.
-}</span></span><span>
</span><span id="line-43"></span><span class="annot"><a href="Toml.Parser.Validate.html#validateItems"><span class="hs-identifier hs-type">validateItems</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Toml.Parser.Validate.html#ValidationError"><span class="hs-identifier hs-type">ValidationError</span></a></span><span> </span><span class="annot"><a href="Toml.Type.TOML.html#TOML"><span class="hs-identifier hs-type">TOML</span></a></span><span>
</span><span id="line-44"></span><span id="validateItems"><span class="annot"><span class="annottext">validateItems :: [TomlItem] -&gt; Either ValidationError TOML
</span><a href="Toml.Parser.Validate.html#validateItems"><span class="hs-identifier hs-var hs-var">validateItems</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="Toml.Parser.Validate.html#validateItemForest"><span class="hs-identifier hs-var">validateItemForest</span></a></span><span> </span><span class="annot"><span class="annottext">(Forest TomlItem -&gt; Either ValidationError TOML)
-&gt; ([TomlItem] -&gt; Forest TomlItem)
-&gt; [TomlItem]
-&gt; Either ValidationError TOML
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[TomlItem] -&gt; Forest TomlItem
</span><a href="Toml.Parser.Validate.html#groupItems"><span class="hs-identifier hs-var">groupItems</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- Grouping</span><span>
</span><span id="line-48"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="annot"><span class="hs-comment">{- | This function takes flat list of 'TomlItem's and groups it into list of
'Tree's by putting all corresponding items inside tables and table arrays.  It
doesn't perform any validation, just groups items according to prefixes of their
keys. So, for example, if you have the following keys as flat list:

@
aaa              # ordinary key
aaa.bbb          # ordinary key
[foo]            # table nam
foo.bar
foo.baz
[xxx]            # table name
[xxx.yyy]        # table name
zzz
@

the following tree structure will be created:

@
aaa
aaa.bbb
[foo]
&#9500;&#9472;&#9472;&#9472;&#9472; foo.bar
&#9492;&#9472;&#9472;&#9472;&#9472; foo.baz
[xxx]
&#9492;&#9472;&#9472;&#9472;&#9472; [yyy]
      &#9492;&#9472;&#9472;&#9472;&#9472; zzz
@
-}</span></span><span>
</span><span id="line-79"></span><span class="annot"><a href="Toml.Parser.Validate.html#groupItems"><span class="hs-identifier hs-type">groupItems</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span>
</span><span id="line-80"></span><span id="groupItems"><span class="annot"><span class="annottext">groupItems :: [TomlItem] -&gt; Forest TomlItem
</span><a href="Toml.Parser.Validate.html#groupItems"><span class="hs-identifier hs-var hs-var">groupItems</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Forest TomlItem, [TomlItem]) -&gt; Forest TomlItem
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Forest TomlItem, [TomlItem]) -&gt; Forest TomlItem)
-&gt; ([TomlItem] -&gt; (Forest TomlItem, [TomlItem]))
-&gt; [TomlItem]
-&gt; Forest TomlItem
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe Key -&gt; [TomlItem] -&gt; (Forest TomlItem, [TomlItem])
</span><a href="Toml.Parser.Validate.html#groupWithParent"><span class="hs-identifier hs-var">groupWithParent</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Key
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="annot"><span class="hs-comment">{- | This function groups list of TOML items into 'Forest' and returns list of
items that are not children of specified parent.

__Invariant:__ When this function is called with 'Nothing', second element in
the result tuple should be empty list.
-}</span></span><span>
</span><span id="line-88"></span><span class="annot"><a href="Toml.Parser.Validate.html#groupWithParent"><span class="hs-identifier hs-type">groupWithParent</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Toml.Type.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ Parent name</span></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span class="hs-special">]</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ List of items</span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="hs-comment">-- ^ Forest of times and remaining items</span></span><span>
</span><span id="line-92"></span><span id="groupWithParent"><span class="annot"><span class="annottext">groupWithParent :: Maybe Key -&gt; [TomlItem] -&gt; (Forest TomlItem, [TomlItem])
</span><a href="Toml.Parser.Validate.html#groupWithParent"><span class="hs-identifier hs-var hs-var">groupWithParent</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Key
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="annot"><a href="Toml.Parser.Validate.html#groupWithParent"><span class="hs-identifier hs-var">groupWithParent</span></a></span><span> </span><span id="local-6989586621679106803"><span class="annot"><span class="annottext">Maybe Key
</span><a href="#local-6989586621679106803"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679106804"><span class="annot"><span class="annottext">TomlItem
</span><a href="#local-6989586621679106804"><span class="hs-identifier hs-var">item</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679106805"><span class="annot"><span class="annottext">[TomlItem]
</span><a href="#local-6989586621679106805"><span class="hs-identifier hs-var">items</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TomlItem
</span><a href="#local-6989586621679106804"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="Toml.Parser.Item.html#KeyVal"><span class="hs-identifier hs-type">KeyVal</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TomlItem -&gt; Forest TomlItem -&gt; Tree TomlItem
forall a. a -&gt; [Tree a] -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">TomlItem
</span><a href="#local-6989586621679106804"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Tree TomlItem
-&gt; (Forest TomlItem, [TomlItem]) -&gt; (Forest TomlItem, [TomlItem])
forall a b. a -&gt; ([a], b) -&gt; ([a], b)
</span><a href="#local-6989586621679106808"><span class="hs-operator hs-var">&lt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Key -&gt; [TomlItem] -&gt; (Forest TomlItem, [TomlItem])
</span><a href="Toml.Parser.Validate.html#groupWithParent"><span class="hs-identifier hs-var">groupWithParent</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Key
</span><a href="#local-6989586621679106803"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">[TomlItem]
</span><a href="#local-6989586621679106805"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="Toml.Parser.Item.html#InlineTable"><span class="hs-identifier hs-type">InlineTable</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TomlItem -&gt; Forest TomlItem -&gt; Tree TomlItem
forall a. a -&gt; [Tree a] -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">TomlItem
</span><a href="#local-6989586621679106804"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Tree TomlItem
-&gt; (Forest TomlItem, [TomlItem]) -&gt; (Forest TomlItem, [TomlItem])
forall a b. a -&gt; ([a], b) -&gt; ([a], b)
</span><a href="#local-6989586621679106808"><span class="hs-operator hs-var">&lt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Key -&gt; [TomlItem] -&gt; (Forest TomlItem, [TomlItem])
</span><a href="Toml.Parser.Validate.html#groupWithParent"><span class="hs-identifier hs-var">groupWithParent</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Key
</span><a href="#local-6989586621679106803"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">[TomlItem]
</span><a href="#local-6989586621679106805"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="Toml.Parser.Item.html#InlineTableArray"><span class="hs-identifier hs-type">InlineTableArray</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TomlItem -&gt; Forest TomlItem -&gt; Tree TomlItem
forall a. a -&gt; [Tree a] -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">TomlItem
</span><a href="#local-6989586621679106804"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Tree TomlItem
-&gt; (Forest TomlItem, [TomlItem]) -&gt; (Forest TomlItem, [TomlItem])
forall a b. a -&gt; ([a], b) -&gt; ([a], b)
</span><a href="#local-6989586621679106808"><span class="hs-operator hs-var">&lt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Key -&gt; [TomlItem] -&gt; (Forest TomlItem, [TomlItem])
</span><a href="Toml.Parser.Validate.html#groupWithParent"><span class="hs-identifier hs-var">groupWithParent</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Key
</span><a href="#local-6989586621679106803"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">[TomlItem]
</span><a href="#local-6989586621679106805"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Toml.Parser.Item.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span id="local-6989586621679106812"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106812"><span class="hs-identifier hs-var">name</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TomlItem -&gt; Key -&gt; (Forest TomlItem, [TomlItem])
</span><a href="#local-6989586621679106813"><span class="hs-identifier hs-var">groupTable</span></a></span><span> </span><span class="annot"><span class="annottext">TomlItem
</span><a href="#local-6989586621679106804"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106812"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="Toml.Parser.Item.html#TableArrayName"><span class="hs-identifier hs-type">TableArrayName</span></a></span><span> </span><span id="local-6989586621679106815"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106815"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TomlItem -&gt; Key -&gt; (Forest TomlItem, [TomlItem])
</span><a href="#local-6989586621679106813"><span class="hs-identifier hs-var">groupTable</span></a></span><span> </span><span class="annot"><span class="annottext">TomlItem
</span><a href="#local-6989586621679106804"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106815"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-comment">-- prepend to the first list, just to remove some code noise</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679106710"><span id="local-6989586621679106711"><span class="annot"><a href="#local-6989586621679106808"><span class="hs-operator hs-type">(&lt;:&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679106710"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679106710"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679106711"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679106710"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679106711"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679106818"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679106818"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679106808"><span class="annot"><span class="annottext">&lt;:&gt; :: forall a b. a -&gt; ([a], b) -&gt; ([a], b)
</span><a href="#local-6989586621679106808"><span class="hs-operator hs-var hs-var">&lt;:&gt;</span></a></span></span><span> </span><span id="local-6989586621679106819"><span class="annot"><span class="annottext">([a], b)
</span><a href="#local-6989586621679106819"><span class="hs-identifier hs-var">tup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a], b) -&gt; ([a], b)
forall a b c. (a -&gt; b) -&gt; (a, c) -&gt; (b, c)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679106818"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a], b)
</span><a href="#local-6989586621679106819"><span class="hs-identifier hs-var">tup</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-comment">-- takes table item and its name, collects all children into table subforest</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- and returns all elements after the table</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="#local-6989586621679106813"><span class="hs-identifier hs-type">groupTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Toml.Type.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679106813"><span class="annot"><span class="annottext">groupTable :: TomlItem -&gt; Key -&gt; (Forest TomlItem, [TomlItem])
</span><a href="#local-6989586621679106813"><span class="hs-identifier hs-var hs-var">groupTable</span></a></span></span><span> </span><span id="local-6989586621679106820"><span class="annot"><span class="annottext">TomlItem
</span><a href="#local-6989586621679106820"><span class="hs-identifier hs-var">tableItem</span></a></span></span><span> </span><span id="local-6989586621679106821"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106821"><span class="hs-identifier hs-var">tableName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Key
</span><a href="#local-6989586621679106803"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><span class="annottext">Maybe Key
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Key -&gt; (Forest TomlItem, [TomlItem])
</span><a href="#local-6989586621679106822"><span class="hs-identifier hs-var">tableWithChildren</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106821"><span class="hs-identifier hs-var">tableName</span></a></span><span>
</span><span id="line-109"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679106823"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106823"><span class="hs-identifier hs-var">parentKey</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Key -&gt; KeysDiff
</span><a href="Toml.Type.Key.html#keysDiff"><span class="hs-identifier hs-var">keysDiff</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106823"><span class="hs-identifier hs-var">parentKey</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106821"><span class="hs-identifier hs-var">tableName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-110"></span><span>            </span><span class="annot"><a href="Toml.Type.Key.html#FstIsPref"><span class="hs-identifier hs-type">FstIsPref</span></a></span><span> </span><span id="local-6989586621679106824"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106824"><span class="hs-identifier hs-var">diff</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Key -&gt; (Forest TomlItem, [TomlItem])
</span><a href="#local-6989586621679106822"><span class="hs-identifier hs-var">tableWithChildren</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106824"><span class="hs-identifier hs-var">diff</span></a></span><span>
</span><span id="line-111"></span><span>            </span><span class="annot"><span class="annottext">KeysDiff
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TomlItem
</span><a href="#local-6989586621679106804"><span class="hs-identifier hs-var">item</span></a></span><span class="annot"><span class="annottext">TomlItem -&gt; [TomlItem] -&gt; [TomlItem]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[TomlItem]
</span><a href="#local-6989586621679106805"><span class="hs-identifier hs-var">items</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><a href="#local-6989586621679106822"><span class="hs-identifier hs-type">tableWithChildren</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Toml.Type.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>        </span><span id="local-6989586621679106822"><span class="annot"><span class="annottext">tableWithChildren :: Key -&gt; (Forest TomlItem, [TomlItem])
</span><a href="#local-6989586621679106822"><span class="hs-identifier hs-var hs-var">tableWithChildren</span></a></span></span><span> </span><span id="local-6989586621679106825"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106825"><span class="hs-identifier hs-var">newName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679106826"><span class="annot"><span class="annottext">Forest TomlItem
</span><a href="#local-6989586621679106826"><span class="hs-identifier hs-var">children</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679106827"><span class="annot"><span class="annottext">[TomlItem]
</span><a href="#local-6989586621679106827"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Key -&gt; [TomlItem] -&gt; (Forest TomlItem, [TomlItem])
</span><a href="Toml.Parser.Validate.html#groupWithParent"><span class="hs-identifier hs-var">groupWithParent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; Maybe Key
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106821"><span class="hs-identifier hs-var">tableName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TomlItem]
</span><a href="#local-6989586621679106805"><span class="hs-identifier hs-var">items</span></a></span><span>
</span><span id="line-116"></span><span>                </span><span id="local-6989586621679106828"><span class="annot"><span class="annottext">newItem :: TomlItem
</span><a href="#local-6989586621679106828"><span class="hs-identifier hs-var hs-var">newItem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; TomlItem -&gt; TomlItem
</span><a href="Toml.Parser.Item.html#setTableName"><span class="hs-identifier hs-var">setTableName</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106825"><span class="hs-identifier hs-var">newName</span></a></span><span> </span><span class="annot"><span class="annottext">TomlItem
</span><a href="#local-6989586621679106820"><span class="hs-identifier hs-var">tableItem</span></a></span><span>
</span><span id="line-117"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">TomlItem -&gt; Forest TomlItem -&gt; Tree TomlItem
forall a. a -&gt; [Tree a] -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">TomlItem
</span><a href="#local-6989586621679106828"><span class="hs-identifier hs-var">newItem</span></a></span><span> </span><span class="annot"><span class="annottext">Forest TomlItem
</span><a href="#local-6989586621679106826"><span class="hs-identifier hs-var">children</span></a></span><span> </span><span class="annot"><span class="annottext">Tree TomlItem
-&gt; (Forest TomlItem, [TomlItem]) -&gt; (Forest TomlItem, [TomlItem])
forall a b. a -&gt; ([a], b) -&gt; ([a], b)
</span><a href="#local-6989586621679106808"><span class="hs-operator hs-var">&lt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Key -&gt; [TomlItem] -&gt; (Forest TomlItem, [TomlItem])
</span><a href="Toml.Parser.Validate.html#groupWithParent"><span class="hs-identifier hs-var">groupWithParent</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Key
</span><a href="#local-6989586621679106803"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">[TomlItem]
</span><a href="#local-6989586621679106827"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- Decoding</span><span>
</span><span id="line-121"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><span class="hs-comment">{- | Error that happens during validating TOML which is already syntactically
correct. For the list of all possible validation errors and their explanation,
see the following issue on GitHub:

* https://github.com/kowainik/tomland/issues/5
-}</span></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-keyword">data</span><span> </span><span id="ValidationError"><span class="annot"><a href="Toml.Parser.Validate.html#ValidationError"><span class="hs-identifier hs-var">ValidationError</span></a></span></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="DuplicateKey"><span class="annot"><a href="Toml.Parser.Validate.html#DuplicateKey"><span class="hs-identifier hs-var">DuplicateKey</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Toml.Type.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DuplicateTable"><span class="annot"><a href="Toml.Parser.Validate.html#DuplicateTable"><span class="hs-identifier hs-var">DuplicateTable</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Toml.Type.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SameNameKeyTable"><span class="annot"><a href="Toml.Parser.Validate.html#SameNameKeyTable"><span class="hs-identifier hs-var">SameNameKeyTable</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Toml.Type.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SameNameTableArray"><span class="annot"><a href="Toml.Parser.Validate.html#SameNameTableArray"><span class="hs-identifier hs-var">SameNameTableArray</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Toml.Type.Key.html#Key"><span class="hs-identifier hs-type">Key</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679106834"><span id="local-6989586621679106846"><span id="local-6989586621679106850"><span class="annot"><span class="annottext">Int -&gt; ValidationError -&gt; ShowS
[ValidationError] -&gt; ShowS
ValidationError -&gt; String
(Int -&gt; ValidationError -&gt; ShowS)
-&gt; (ValidationError -&gt; String)
-&gt; ([ValidationError] -&gt; ShowS)
-&gt; Show ValidationError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ValidationError -&gt; ShowS
showsPrec :: Int -&gt; ValidationError -&gt; ShowS
$cshow :: ValidationError -&gt; String
show :: ValidationError -&gt; String
$cshowList :: [ValidationError] -&gt; ShowS
showList :: [ValidationError] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679106854"><span id="local-6989586621679106860"><span class="annot"><span class="annottext">ValidationError -&gt; ValidationError -&gt; Bool
(ValidationError -&gt; ValidationError -&gt; Bool)
-&gt; (ValidationError -&gt; ValidationError -&gt; Bool)
-&gt; Eq ValidationError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ValidationError -&gt; ValidationError -&gt; Bool
== :: ValidationError -&gt; ValidationError -&gt; Bool
$c/= :: ValidationError -&gt; ValidationError -&gt; Bool
/= :: ValidationError -&gt; ValidationError -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="annot"><span class="hs-comment">{- | Construct 'TOML' from the 'Forest' of 'TomlItem' and performing validation
of TOML at the same time.
-}</span></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Toml.Parser.Validate.html#validateItemForest"><span class="hs-identifier hs-type">validateItemForest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Toml.Parser.Validate.html#ValidationError"><span class="hs-identifier hs-type">ValidationError</span></a></span><span> </span><span class="annot"><a href="Toml.Type.TOML.html#TOML"><span class="hs-identifier hs-type">TOML</span></a></span><span>
</span><span id="line-141"></span><span id="validateItemForest"><span class="annot"><span class="annottext">validateItemForest :: Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="Toml.Parser.Validate.html#validateItemForest"><span class="hs-identifier hs-var hs-var">validateItemForest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TOML -&gt; Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106864"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TOML
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="#local-6989586621679106864"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Toml.Type.TOML.html#TOML"><span class="hs-identifier hs-type">TOML</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="annot"><a href="Toml.Parser.Item.html#TomlItem"><span class="hs-identifier hs-type">TomlItem</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Toml.Parser.Validate.html#ValidationError"><span class="hs-identifier hs-type">ValidationError</span></a></span><span> </span><span class="annot"><a href="Toml.Type.TOML.html#TOML"><span class="hs-identifier hs-type">TOML</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621679106864"><span class="annot"><span class="annottext">go :: TOML -&gt; Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106864"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679106865"><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106865"><span class="hs-identifier hs-var">toml</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TOML -&gt; Either ValidationError TOML
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106865"><span class="hs-identifier hs-var">toml</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="#local-6989586621679106864"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679106866"><span class="annot"><span class="annottext">toml :: TOML
</span><a href="#local-6989586621679106866"><span class="hs-identifier hs-var">toml</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Toml.Type.TOML.html#TOML"><span class="hs-identifier hs-type">TOML</span></a></span><span class="hs-special">{</span><span id="local-6989586621679106867"><span id="local-6989586621679106868"><span id="local-6989586621679106869"><span class="annot"><span class="annottext">HashMap Key (NonEmpty TOML)
HashMap Key AnyValue
PrefixMap TOML
tomlPairs :: HashMap Key AnyValue
tomlTables :: PrefixMap TOML
tomlTableArrays :: HashMap Key (NonEmpty TOML)
tomlTableArrays :: TOML -&gt; HashMap Key (NonEmpty TOML)
tomlTables :: TOML -&gt; PrefixMap TOML
tomlPairs :: TOML -&gt; HashMap Key AnyValue
</span><a href="#local-6989586621679106867"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679106873"><span class="annot"><span class="annottext">Tree TomlItem
</span><a href="#local-6989586621679106873"><span class="hs-identifier hs-var">node</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679106874"><span class="annot"><span class="annottext">Forest TomlItem
</span><a href="#local-6989586621679106874"><span class="hs-identifier hs-var">nodes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Tree TomlItem -&gt; TomlItem
forall a. Tree a -&gt; a
</span><span class="hs-identifier hs-var">rootLabel</span></span><span> </span><span class="annot"><span class="annottext">Tree TomlItem
</span><a href="#local-6989586621679106873"><span class="hs-identifier hs-var">node</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-comment">-- ignore subforest here</span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><a href="Toml.Parser.Item.html#KeyVal"><span class="hs-identifier hs-type">KeyVal</span></a></span><span> </span><span id="local-6989586621679106876"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106876"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679106877"><span class="annot"><span class="annottext">AnyValue
</span><a href="#local-6989586621679106877"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-148"></span><span>            </span><span class="annot"><span class="annottext">Key -&gt; HashMap Key AnyValue -&gt; Maybe AnyValue
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HashMap.lookup</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106876"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Key AnyValue
</span><a href="#local-6989586621679106867"><span class="hs-identifier hs-var">tomlPairs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AnyValue -&gt; ValidationError -&gt; Either ValidationError ()
forall a e. Maybe a -&gt; e -&gt; Either e ()
</span><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-operator hs-var">`errorOnJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ValidationError
</span><a href="Toml.Parser.Validate.html#DuplicateKey"><span class="hs-identifier hs-var">DuplicateKey</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106876"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-149"></span><span>            </span><span class="annot"><span class="annottext">Key -&gt; PrefixMap TOML -&gt; Maybe TOML
forall a. Key -&gt; PrefixMap a -&gt; Maybe a
</span><a href="Toml.Type.PrefixTree.html#lookup"><span class="hs-identifier hs-var">PrefixMap.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106876"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">PrefixMap TOML
</span><a href="#local-6989586621679106868"><span class="hs-identifier hs-var">tomlTables</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TOML -&gt; ValidationError -&gt; Either ValidationError ()
forall a e. Maybe a -&gt; e -&gt; Either e ()
</span><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-operator hs-var">`errorOnJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ValidationError
</span><a href="Toml.Parser.Validate.html#SameNameKeyTable"><span class="hs-identifier hs-var">SameNameKeyTable</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106876"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-150"></span><span>            </span><span class="annot"><span class="annottext">TOML -&gt; Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106864"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; AnyValue -&gt; TOML -&gt; TOML
</span><a href="Toml.Type.TOML.html#insertKeyAnyVal"><span class="hs-identifier hs-var">insertKeyAnyVal</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106876"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">AnyValue
</span><a href="#local-6989586621679106877"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106866"><span class="hs-identifier hs-var">toml</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Forest TomlItem
</span><a href="#local-6989586621679106874"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-comment">-- ignore subforest here</span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><a href="Toml.Parser.Item.html#InlineTable"><span class="hs-identifier hs-type">InlineTable</span></a></span><span> </span><span id="local-6989586621679106881"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106881"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679106882"><span class="annot"><span class="annottext">Table
</span><a href="#local-6989586621679106882"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-154"></span><span>            </span><span class="annot"><span class="annottext">Key -&gt; HashMap Key AnyValue -&gt; Maybe AnyValue
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HashMap.lookup</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106881"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Key AnyValue
</span><a href="#local-6989586621679106867"><span class="hs-identifier hs-var">tomlPairs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AnyValue -&gt; ValidationError -&gt; Either ValidationError ()
forall a e. Maybe a -&gt; e -&gt; Either e ()
</span><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-operator hs-var">`errorOnJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ValidationError
</span><a href="Toml.Parser.Validate.html#SameNameKeyTable"><span class="hs-identifier hs-var">SameNameKeyTable</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106881"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-155"></span><span>            </span><span class="annot"><span class="annottext">Key -&gt; HashMap Key (NonEmpty TOML) -&gt; Maybe (NonEmpty TOML)
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HashMap.lookup</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106881"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Key (NonEmpty TOML)
</span><a href="#local-6989586621679106869"><span class="hs-identifier hs-var">tomlTableArrays</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty TOML)
-&gt; ValidationError -&gt; Either ValidationError ()
forall a e. Maybe a -&gt; e -&gt; Either e ()
</span><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-operator hs-var">`errorOnJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ValidationError
</span><a href="Toml.Parser.Validate.html#SameNameTableArray"><span class="hs-identifier hs-var">SameNameTableArray</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106881"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-156"></span><span>            </span><span class="annot"><span class="annottext">Key -&gt; PrefixMap TOML -&gt; Maybe TOML
forall a. Key -&gt; PrefixMap a -&gt; Maybe a
</span><a href="Toml.Type.PrefixTree.html#lookup"><span class="hs-identifier hs-var">PrefixMap.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106881"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">PrefixMap TOML
</span><a href="#local-6989586621679106868"><span class="hs-identifier hs-var">tomlTables</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TOML -&gt; ValidationError -&gt; Either ValidationError ()
forall a e. Maybe a -&gt; e -&gt; Either e ()
</span><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-operator hs-var">`errorOnJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ValidationError
</span><a href="Toml.Parser.Validate.html#DuplicateTable"><span class="hs-identifier hs-var">DuplicateTable</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106881"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-157"></span><span>            </span><span id="local-6989586621679106883"><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106883"><span class="hs-identifier hs-var">tableToml</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Table -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106884"><span class="hs-identifier hs-var">createTomlFromTable</span></a></span><span> </span><span class="annot"><span class="annottext">Table
</span><a href="#local-6989586621679106882"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-158"></span><span>            </span><span class="annot"><span class="annottext">TOML -&gt; Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106864"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; TOML -&gt; TOML -&gt; TOML
</span><a href="Toml.Type.TOML.html#insertTable"><span class="hs-identifier hs-var">insertTable</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106881"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106883"><span class="hs-identifier hs-var">tableToml</span></a></span><span> </span><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106866"><span class="hs-identifier hs-var">toml</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Forest TomlItem
</span><a href="#local-6989586621679106874"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-comment">-- ignore subforest here</span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><a href="Toml.Parser.Item.html#InlineTableArray"><span class="hs-identifier hs-type">InlineTableArray</span></a></span><span> </span><span id="local-6989586621679106885"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106885"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679106886"><span class="annot"><span class="annottext">NonEmpty Table
</span><a href="#local-6989586621679106886"><span class="hs-identifier hs-var">tables</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>            </span><span class="annot"><span class="annottext">Key -&gt; PrefixMap TOML -&gt; Maybe TOML
forall a. Key -&gt; PrefixMap a -&gt; Maybe a
</span><a href="Toml.Type.PrefixTree.html#lookup"><span class="hs-identifier hs-var">PrefixMap.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106885"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">PrefixMap TOML
</span><a href="#local-6989586621679106868"><span class="hs-identifier hs-var">tomlTables</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TOML -&gt; ValidationError -&gt; Either ValidationError ()
forall a e. Maybe a -&gt; e -&gt; Either e ()
</span><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-operator hs-var">`errorOnJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ValidationError
</span><a href="Toml.Parser.Validate.html#SameNameTableArray"><span class="hs-identifier hs-var">SameNameTableArray</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106885"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-163"></span><span>            </span><span id="local-6989586621679106887"><span class="annot"><span class="annottext">NonEmpty TOML
</span><a href="#local-6989586621679106887"><span class="hs-identifier hs-var">arrayToml</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Table -&gt; Either ValidationError TOML)
-&gt; NonEmpty Table -&gt; Either ValidationError (NonEmpty TOML)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; NonEmpty a -&gt; m (NonEmpty b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Table -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106884"><span class="hs-identifier hs-var">createTomlFromTable</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty Table
</span><a href="#local-6989586621679106886"><span class="hs-identifier hs-var">tables</span></a></span><span>
</span><span id="line-164"></span><span>            </span><span class="annot"><span class="annottext">TOML -&gt; Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106864"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; NonEmpty TOML -&gt; TOML -&gt; TOML
</span><a href="Toml.Type.TOML.html#insertTableArrays"><span class="hs-identifier hs-var">insertTableArrays</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106885"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty TOML
</span><a href="#local-6989586621679106887"><span class="hs-identifier hs-var">arrayToml</span></a></span><span> </span><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106866"><span class="hs-identifier hs-var">toml</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Forest TomlItem
</span><a href="#local-6989586621679106874"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><a href="Toml.Parser.Item.html#TableName"><span class="hs-identifier hs-type">TableName</span></a></span><span> </span><span id="local-6989586621679106889"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106889"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-167"></span><span>            </span><span class="annot"><span class="annottext">Key -&gt; HashMap Key AnyValue -&gt; Maybe AnyValue
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HashMap.lookup</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106889"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Key AnyValue
</span><a href="#local-6989586621679106867"><span class="hs-identifier hs-var">tomlPairs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AnyValue -&gt; ValidationError -&gt; Either ValidationError ()
forall a e. Maybe a -&gt; e -&gt; Either e ()
</span><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-operator hs-var">`errorOnJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ValidationError
</span><a href="Toml.Parser.Validate.html#SameNameKeyTable"><span class="hs-identifier hs-var">SameNameKeyTable</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106889"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-168"></span><span>            </span><span class="annot"><span class="annottext">Key -&gt; HashMap Key (NonEmpty TOML) -&gt; Maybe (NonEmpty TOML)
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HashMap.lookup</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106889"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Key (NonEmpty TOML)
</span><a href="#local-6989586621679106869"><span class="hs-identifier hs-var">tomlTableArrays</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (NonEmpty TOML)
-&gt; ValidationError -&gt; Either ValidationError ()
forall a e. Maybe a -&gt; e -&gt; Either e ()
</span><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-operator hs-var">`errorOnJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ValidationError
</span><a href="Toml.Parser.Validate.html#SameNameTableArray"><span class="hs-identifier hs-var">SameNameTableArray</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106889"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-169"></span><span>            </span><span class="annot"><span class="annottext">Key -&gt; PrefixMap TOML -&gt; Maybe TOML
forall a. Key -&gt; PrefixMap a -&gt; Maybe a
</span><a href="Toml.Type.PrefixTree.html#lookup"><span class="hs-identifier hs-var">PrefixMap.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106889"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">PrefixMap TOML
</span><a href="#local-6989586621679106868"><span class="hs-identifier hs-var">tomlTables</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TOML -&gt; ValidationError -&gt; Either ValidationError ()
forall a e. Maybe a -&gt; e -&gt; Either e ()
</span><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-operator hs-var">`errorOnJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ValidationError
</span><a href="Toml.Parser.Validate.html#DuplicateTable"><span class="hs-identifier hs-var">DuplicateTable</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106889"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-170"></span><span>            </span><span id="local-6989586621679106890"><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106890"><span class="hs-identifier hs-var">subTable</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TOML -&gt; Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106864"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TOML
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tree TomlItem -&gt; Forest TomlItem
forall a. Tree a -&gt; [Tree a]
</span><span class="hs-identifier hs-var">subForest</span></span><span> </span><span class="annot"><span class="annottext">Tree TomlItem
</span><a href="#local-6989586621679106873"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>            </span><span class="annot"><span class="annottext">TOML -&gt; Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106864"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; TOML -&gt; TOML -&gt; TOML
</span><a href="Toml.Type.TOML.html#insertTable"><span class="hs-identifier hs-var">insertTable</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106889"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106890"><span class="hs-identifier hs-var">subTable</span></a></span><span> </span><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106866"><span class="hs-identifier hs-var">toml</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Forest TomlItem
</span><a href="#local-6989586621679106874"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><a href="Toml.Parser.Item.html#TableArrayName"><span class="hs-identifier hs-type">TableArrayName</span></a></span><span> </span><span id="local-6989586621679106892"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106892"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-174"></span><span>            </span><span class="annot"><span class="annottext">Key -&gt; PrefixMap TOML -&gt; Maybe TOML
forall a. Key -&gt; PrefixMap a -&gt; Maybe a
</span><a href="Toml.Type.PrefixTree.html#lookup"><span class="hs-identifier hs-var">PrefixMap.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106892"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">PrefixMap TOML
</span><a href="#local-6989586621679106868"><span class="hs-identifier hs-var">tomlTables</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TOML -&gt; ValidationError -&gt; Either ValidationError ()
forall a e. Maybe a -&gt; e -&gt; Either e ()
</span><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-operator hs-var">`errorOnJust`</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ValidationError
</span><a href="Toml.Parser.Validate.html#SameNameTableArray"><span class="hs-identifier hs-var">SameNameTableArray</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106892"><span class="hs-identifier hs-var">key</span></a></span><span>
</span><span id="line-175"></span><span>            </span><span id="local-6989586621679106893"><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106893"><span class="hs-identifier hs-var">subTable</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TOML -&gt; Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106864"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TOML
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tree TomlItem -&gt; Forest TomlItem
forall a. Tree a -&gt; [Tree a]
</span><span class="hs-identifier hs-var">subForest</span></span><span> </span><span class="annot"><span class="annottext">Tree TomlItem
</span><a href="#local-6989586621679106873"><span class="hs-identifier hs-var">node</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679106902"><span class="annot"><span class="annottext">newArray :: HashMap Key (NonEmpty TOML)
</span><a href="#local-6989586621679106902"><span class="hs-identifier hs-var hs-var">newArray</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Key -&gt; HashMap Key (NonEmpty TOML) -&gt; Maybe (NonEmpty TOML)
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><span class="hs-identifier hs-var">HashMap.lookup</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106892"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap Key (NonEmpty TOML)
</span><a href="#local-6989586621679106869"><span class="hs-identifier hs-var">tomlTableArrays</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-177"></span><span>                    </span><span class="annot"><span class="annottext">Maybe (NonEmpty TOML)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Key
-&gt; NonEmpty TOML
-&gt; HashMap Key (NonEmpty TOML)
-&gt; HashMap Key (NonEmpty TOML)
forall k v.
(Eq k, Hashable k) =&gt;
k -&gt; v -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HashMap.insert</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106892"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106893"><span class="hs-identifier hs-var">subTable</span></a></span><span> </span><span class="annot"><span class="annottext">TOML -&gt; [TOML] -&gt; NonEmpty TOML
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashMap Key (NonEmpty TOML)
</span><a href="#local-6989586621679106869"><span class="hs-identifier hs-var">tomlTableArrays</span></a></span><span>
</span><span id="line-178"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679106905"><span class="annot"><span class="annottext">NonEmpty TOML
</span><a href="#local-6989586621679106905"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-179"></span><span>                        </span><span class="annot"><span class="annottext">Key
-&gt; NonEmpty TOML
-&gt; HashMap Key (NonEmpty TOML)
-&gt; HashMap Key (NonEmpty TOML)
forall k v.
(Eq k, Hashable k) =&gt;
k -&gt; v -&gt; HashMap k v -&gt; HashMap k v
</span><span class="hs-identifier hs-var">HashMap.insert</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106892"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty TOML
</span><a href="#local-6989586621679106905"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty TOML -&gt; NonEmpty TOML -&gt; NonEmpty TOML
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106893"><span class="hs-identifier hs-var">subTable</span></a></span><span> </span><span class="annot"><span class="annottext">TOML -&gt; [TOML] -&gt; NonEmpty TOML
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashMap Key (NonEmpty TOML)
</span><a href="#local-6989586621679106869"><span class="hs-identifier hs-var">tomlTableArrays</span></a></span><span>
</span><span id="line-180"></span><span>            </span><span class="annot"><span class="annottext">TOML -&gt; Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106864"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TOML
</span><a href="#local-6989586621679106866"><span class="hs-identifier hs-var">toml</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Toml.Type.TOML.html#tomlTableArrays"><span class="hs-identifier hs-var">tomlTableArrays</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679106902"><span class="hs-identifier hs-type">newArray</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Forest TomlItem
</span><a href="#local-6989586621679106874"><span class="hs-identifier hs-var">nodes</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><a href="#local-6989586621679106884"><span class="hs-identifier hs-type">createTomlFromTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Toml.Parser.Item.html#Table"><span class="hs-identifier hs-type">Table</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="Toml.Parser.Validate.html#ValidationError"><span class="hs-identifier hs-type">ValidationError</span></a></span><span> </span><span class="annot"><a href="Toml.Type.TOML.html#TOML"><span class="hs-identifier hs-type">TOML</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679106884"><span class="annot"><span class="annottext">createTomlFromTable :: Table -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106884"><span class="hs-identifier hs-var hs-var">createTomlFromTable</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Toml.Parser.Item.html#Table"><span class="hs-identifier hs-type">Table</span></a></span><span> </span><span id="local-6989586621679106907"><span class="annot"><span class="annottext">[(Key, AnyValue)]
</span><a href="#local-6989586621679106907"><span class="hs-identifier hs-var">table</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>        </span><span class="annot"><span class="annottext">TOML -&gt; Forest TomlItem -&gt; Either ValidationError TOML
</span><a href="#local-6989586621679106864"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TOML
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(Forest TomlItem -&gt; Either ValidationError TOML)
-&gt; Forest TomlItem -&gt; Either ValidationError TOML
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Key, AnyValue) -&gt; Tree TomlItem)
-&gt; [(Key, AnyValue)] -&gt; Forest TomlItem
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679106908"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106908"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679106909"><span class="annot"><span class="annottext">AnyValue
</span><a href="#local-6989586621679106909"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TomlItem -&gt; Forest TomlItem -&gt; Tree TomlItem
forall a. a -&gt; [Tree a] -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; AnyValue -&gt; TomlItem
</span><a href="Toml.Parser.Item.html#KeyVal"><span class="hs-identifier hs-var">KeyVal</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679106908"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">AnyValue
</span><a href="#local-6989586621679106909"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Key, AnyValue)]
</span><a href="#local-6989586621679106907"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span id="local-6989586621679106732"><span id="local-6989586621679106733"><span class="annot"><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-identifier hs-type">errorOnJust</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679106732"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679106733"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679106733"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-189"></span><span id="errorOnJust"><span class="annot"><span class="annottext">errorOnJust :: forall a e. Maybe a -&gt; e -&gt; Either e ()
</span><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-identifier hs-var hs-var">errorOnJust</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679106910"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679106910"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">e -&gt; Either e ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679106910"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-190"></span><span class="annot"><a href="Toml.Parser.Validate.html#errorOnJust"><span class="hs-identifier hs-var">errorOnJust</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="annot"><span class="annottext">e
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Either e ()
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-191"></span></pre></body></html>